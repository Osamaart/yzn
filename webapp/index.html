
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ© - Ù…Ø´Ø±ÙˆØ¹ ÙŠØ²Ù†</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&display=swap');
  
  :root{
    --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --card: #ffffff;
    --text-primary: #1f2937;
    --text-secondary: #6b7280;
    --easy: #10b981;
    --medium: #f59e0b;
    --hard: #ef4444;
    --shadow: 0 20px 60px rgba(0,0,0,0.15);
  }
  
  [data-theme="dark"] {
    --bg-gradient: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    --card: #1e293b;
    --text-primary: #f1f5f9;
    --text-secondary: #cbd5e1;
    --easy: #10b981;
    --medium: #fbbf24;
    --hard: #f87171;
    --shadow: 0 20px 60px rgba(0,0,0,0.5);
  }
  
  *{box-sizing:border-box; margin:0; padding:0;}
  
  body{
  font-family:"Almarai", Tahoma, Arial;
  background: var(--bg-gradient);
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
  transition: background 0.3s ease;
}

  /* Ø²Ø± ÙˆØ¶Ø¹ Ø§Ù„Ø¸Ù„Ø§Ù… */
  .theme-toggle {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 9999;
    background: var(--card);
    border: 3px solid #667eea;
    border-radius: 50px;
    padding: 12px 20px;
    cursor: pointer;
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 700;
    color: var(--text-primary);
    transition: all 0.3s ease;
  }
  
  .theme-toggle:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
  }
  
  .theme-toggle .icon {
    font-size: 20px;
  }
  
.page-section {
  display: none !important;
}

.page-section.active {
  display: flex !important;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 40px 20px;
  position: relative;
}
  
  .hero-card {
    background: var(--card);
    border-radius: 30px;
    padding: 60px 40px;
    max-width: 900px;
    width: 100%;
    box-shadow: var(--shadow);
    text-align: center;
    animation: fadeInUp 0.8s ease-out;
    margin: auto;
    transition: all 0.3s ease;
  }
  
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
  }
  
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }
  
  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    75% { transform: translateX(8px); }
  }
  
  .math-icons {
    font-size: 60px;
    margin-bottom: 20px;
    letter-spacing: 10px;
  }
  
  .hero-title {
    font-size: 42px;
    font-weight: 800;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 15px;
  }
  
  .hero-subtitle {
    font-size: 24px;
    color: var(--text-secondary);
    margin-bottom: 30px;
  }
  
  .project-info {
    background: linear-gradient(135deg, #f0f4ff 0%, #f9f0ff 100%);
    border-radius: 20px;
    padding: 30px;
    margin: 30px 0;
    border: 2px solid #e0e7ff;
  }
  
  .author-name {
    font-size: 28px;
    font-weight: 800;
    color: #667eea;
    margin-bottom: 10px;
  }
  
  .project-details {
    font-size: 16px;
    color: var(--text-secondary);
    line-height: 1.8;
  }
  
  .start-btn, .calc-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 20px 60px;
    font-size: 22px;
    font-weight: 800;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    transition: all 0.3s ease;
    font-family: inherit;
    margin: 10px;
  }
  
  .calc-btn {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
  }
  
  .start-btn:hover, .calc-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
  }
  
  .calc-btn:hover {
    box-shadow: 0 15px 40px rgba(16, 185, 129, 0.6);
  }
  
 .level-container, .calc-container {
  max-width: 1100px;
  margin: 0 auto;
  min-height: 100vh;
  padding: 20px;
}
  
  .page-header {
    text-align: center;
    color: white;
    margin-bottom: 50px;
    padding-top: 40px;
  }
  
  .page-header h1 {
    font-size: 48px;
    font-weight: 800;
    margin-bottom: 10px;
    text-shadow: 0 2px 10px rgba(0,0,0,0.2);
  }
  
  .page-header p {
    font-size: 20px;
    opacity: 0.9;
  }
  
  .levels-grid {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: stretch;
    gap: 30px;
    margin-top: 40px;
    flex-wrap: wrap;
  }
  
  .level-card {
    background: var(--card);
    border-radius: 25px;
    padding: 40px 30px;
    text-align: center;
    cursor: pointer;
    transition: all 0.4s ease;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    border: 4px solid transparent;
    flex: 0 1 300px;
    min-width: 280px;
  }
  
  .level-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 50px rgba(0,0,0,0.2);
  }
  
  .level-card.easy { border-color: var(--easy); }
  .level-card.medium { border-color: var(--medium); }
  .level-card.hard { border-color: var(--hard); }
  
  .level-icon {
    width: 120px;
    height: 120px;
    margin: 0 auto 25px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0;
    position: relative;
    transition: all 0.3s ease;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3),
                inset 0 -4px 12px rgba(0,0,0,0.3),
                inset 0 4px 12px rgba(255,255,255,0.6);
  }
  
  .level-card.easy .level-icon {
    background: linear-gradient(145deg, #10b981, #047857);
  }
  
  .level-card.medium .level-icon {
    background: linear-gradient(145deg, #f59e0b, #d97706);
  }
  
  .level-card.hard .level-icon {
    background: linear-gradient(145deg, #ef4444, #dc2626);
  }
  
  .level-card:hover .level-icon {
    transform: scale(1.1);
    box-shadow: 0 15px 40px rgba(0,0,0,0.4),
                inset 0 -4px 12px rgba(0,0,0,0.3),
                inset 0 4px 12px rgba(255,255,255,0.6);
  }
  
  /* ØµÙØ­Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆØ§Ù„ */
  .functions-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 25px;
    margin-top: 40px;
    max-width: 1100px;
    margin-left: auto;
    margin-right: auto;
  }
  
  @media (max-width: 968px) {
    .functions-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  @media (max-width: 640px) {
    .functions-grid {
      grid-template-columns: 1fr;
    }
  }
  
  .function-card {
    background: var(--card);
    border-radius: 20px;
    padding: 30px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    border: 3px solid transparent;
  }
  
  .function-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 15px 40px rgba(102, 126, 234, 0.25);
    border-color: #667eea;
  }
  
  .function-icon {
    font-size: 60px;
    margin-bottom: 15px;
    transition: transform 0.3s ease;
  }
  
  .function-card:hover .function-icon {
    animation: bounce 0.8s ease-in-out;
  }
  
  .function-card h3 {
    font-size: 22px;
    font-weight: 800;
    margin-bottom: 8px;
    color: #667eea;
  }
  
  .function-card p {
    font-size: 14px;
    color: #666;
    margin-bottom: 15px;
  }
  
  .function-formula {
    background: linear-gradient(135deg, #f0f4ff 0%, #e8f0ff 100%);
    padding: 15px;
    border-radius: 12px;
    font-size: 18px;
    font-weight: 700;
    color: #764ba2;
    font-family: 'Courier New', monospace;
  }
  
  .level-title {
    font-size: 32px;
    font-weight: 800;
    margin-bottom: 15px;
  }
  
  .level-card.easy .level-title { color: var(--easy); }
  .level-card.medium .level-title { color: var(--medium); }
  .level-card.hard .level-title { color: var(--hard); }
  
  .level-desc {
    color: var(--text-secondary);
    font-size: 16px;
    margin-bottom: 20px;
    line-height: 1.6;
  }
  
  .level-badge {
    display: inline-block;
    padding: 8px 20px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 700;
    color: white;
  }
  
  .level-card.easy .level-badge { background: var(--easy); }
  .level-card.medium .level-badge { background: var(--medium); }
  .level-card.hard .level-badge { background: var(--hard); }
  
.quiz-wrapper {
  display: flex;
  min-height: 100vh;
  gap: 0;
  width: 100%;
}

#quizPage.active {
  display: block !important;
}

.side-progress {
  width: 100px;
  background: linear-gradient(180deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.95) 100%);
  backdrop-filter: blur(10px);
  box-shadow: 4px 0 20px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 30px 10px;
  position: sticky;
  top: 0;
  height: 100vh;
}

.progress-percentage {
  width: 70px;
  min-width: 70px;
  height: 70px;
  min-height: 70px;
  border-radius: 50%;
  background: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: 900;
  color: #667eea;
  margin-bottom: 30px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  flex-shrink: 0;
}

.progress-steps {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 20px;
  width: 100%;
  align-items: center;
  justify-content: center;
}

.progress-step {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  font-weight: 700;
  color: white;
  transition: all 0.3s;
  border: 3px solid transparent;
}

.progress-step.completed {
  background: #10b981;
  border-color: white;
  animation: pulse 0.5s;
}

.progress-step.current {
  background: #f59e0b;
  border-color: white;
  transform: scale(1.15);
  animation: pulse 1s infinite;
}

.progress-step.wrong {
  background: #ef4444;
  border-color: white;
  animation: shake 0.5s;
}

.quiz-container {
  flex: 1;
  max-width: 1200px;
  margin: 0 auto;
  min-height: 100vh;
  padding: 20px;
} 
  
  .quiz-header {
    background: var(--card);
    border-radius: 20px;
    padding: 25px 30px;
    margin-bottom: 30px;
    box-shadow: var(--shadow);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
    position: relative;
    z-index: 10;
  }
  
  .quiz-title {
    font-size: 28px;
    font-weight: 800;
    color: var(--text-primary);
  }
  
  .quiz-meta {
    display: flex;
    gap: 10px;
    align-items: center;
  }
  
  .progress-bar-container {
    width: 100%;
    background: #e5e7eb;
    border-radius: 20px;
    height: 8px;
    overflow: hidden;
    margin: 15px 0;
  }
  
  .progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #10b981 0%, #059669 100%);
    border-radius: 20px;
    transition: width 0.5s ease;
  }
  
  .streak-badge {
    padding: 8px 16px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 14px;
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
    white-space: nowrap;
    display: none;
  }
  
  .streak-badge.active {
    display: inline-block;
    animation: bounce 0.5s ease;
  }
  

  
  @keyframes fadeInScale {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
  }
  
  .confetti {
    position: fixed;
    width: 10px;
    height: 10px;
    background: #f0f;
    position: absolute;
    animation: confetti-fall 3s linear forwards;
  }
  
  @keyframes confetti-fall {
    to {
      transform: translateY(100vh) rotate(360deg);
      opacity: 0;
    }
  }
  
  .encouragement-msg {
    text-align: center;
    padding: 15px;
    margin: 15px 0;
    border-radius: 15px;
    font-weight: 700;
    font-size: 18px;
    animation: slideIn 0.5s ease;
    display: none;
  }
  
  .encouragement-msg.success {
    background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
    color: #065f46;
    border: 2px solid #10b981;
  }
  
  .encouragement-msg.info {
    background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
    color: #1e40af;
    border: 2px solid #3b82f6;
  }
  
  .encouragement-msg.show {
    display: block;
  }
  
  .timer-badge {
    padding: 10px 18px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 15px;
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
    white-space: nowrap;
  }
  
  .timer-badge.warning {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    animation: pulse 1s ease-in-out infinite;
  }
  
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }
  
  .score-badge {
    padding: 10px 18px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 15px;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    white-space: nowrap;
  }
  
  .back-btn {
    background: #6b7280;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 20px;
    cursor: pointer;
    font-weight: 700;
    transition: all 0.3s;
    font-family: inherit;
    font-size: 15px;
    pointer-events: auto;
    position: relative;
    z-index: 100;
    user-select: none;
  }
  
  .back-btn:hover {
    background: #4b5563;
    transform: translateY(-2px);
  }
  
  .back-btn:active {
    transform: translateY(0);
    background: #374151;
  }
  
  .qcard {
    background: var(--card);
    border-radius: 25px;
    padding: 30px;
    box-shadow: var(--shadow);
    margin-bottom: 30px;
    display: grid;
    grid-template-columns: 42% 58%;
    gap: 30px;
    align-items: start;
  }
  
  .panel-right, .panel-left {
    min-width: 0;
  }
  
  .funcTitle {
    font-weight: 800;
    font-size: 22px;
    color: var(--text-primary);
    margin-bottom: 12px;
  }
  
  .asks {
    color: #667eea;
    font-size: 15px;
    margin-bottom: 15px;
    font-weight: 700;
    padding: 12px;
    background: #f0f4ff;
    border-radius: 10px;
    border-right: 4px solid #667eea;
    line-height: 1.5;
  }
  
  .chart-wrapper {
    background: var(--card);
    border-radius: 12px;
    border: 2px solid #e5e7eb;
    padding: 10px;
    margin-bottom: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }
  
  [data-theme="dark"] .chart-wrapper {
    border-color: #475569;
  }
  
  canvas {
    width: 100% !important;
    height: 280px !important;
  }
  
  .options {
    display: grid;
    gap: 15px;
  }
  
  .opt {
    padding: 20px 22px;
    border-radius: 14px;
    background: #f9fafb;
    cursor: pointer;
    border: 3px solid transparent;
    transition: all 0.3s;
    font-size: 17px;
    font-weight: 600;
    line-height: 1.5;
    word-wrap: break-word;
  }
  
  .opt:hover:not(.answered) {
    transform: translateX(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    border-color: #e5e7eb;
  }
  
  .opt.correct {
    border-color: var(--easy);
    background: rgba(16, 185, 129, 0.1);
    color: var(--easy);
    animation: fadeInScale 0.5s ease;
  }
  
  .opt.wrong {
    border-color: var(--hard);
    background: rgba(239, 68, 68, 0.1);
    color: var(--hard);
    opacity: 0.7;
    animation: shake 0.5s ease;
  }
  
  .opt.answered {
    cursor: default;
    pointer-events: none;
  }
  
  .explanation-box {
    margin-top: 20px;
    padding: 20px;
    border-radius: 15px;
    background: #f1f5f9;
    border-right: 5px solid;
    line-height: 1.8;
    font-size: 16px;
    text-align: right;
    animation: slideIn 0.4s ease-out;
  }
  
  .explanation-title {
    font-weight: 800;
    font-size: 17px;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .explanation-content {
    margin-top: 10px;
    font-size: 15px;
    line-height: 1.8;
  }
  
  .explanation-steps {
    margin-top: 12px;
    padding: 12px;
    background: rgba(255,255,255,0.5);
    border-radius: 10px;
    font-size: 14px;
    line-height: 1.7;
  }
  
  @keyframes slideIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .explanation-box.good { border-color: var(--easy); background: rgba(16, 185, 129, 0.05); }
  .explanation-box.bad { border-color: var(--hard); background: rgba(239, 68, 68, 0.05); }
  
  .btn-hint {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 700;
    width: 100%;
    margin-top: 15px;
    transition: all 0.3s;
    font-family: inherit;
  }
  
  .btn-hint:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
  }
  
  .hint-box {
    margin-top: 15px;
    animation: fadeIn 0.3s ease-in-out;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .btn-finish {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    border: none;
    padding: 18px;
    border-radius: 15px;
    cursor: pointer;
    font-weight: 800;
    font-size: 20px;
    width: 100%;
    margin-top: 30px;
    box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
    transition: all 0.3s;
    font-family: inherit;
  }
  
  .btn-finish:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 40px rgba(16, 185, 129, 0.5);
  }
  
  #finalScore {
    background: var(--card);
    padding: 50px;
    border-radius: 30px;
    box-shadow: 0 30px 60px rgba(0,0,0,0.3);
    text-align: center;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
    width: 90%;
    max-width: 550px;
    border: 5px solid #667eea;
    display: none;
    animation: fadeInScale 0.5s ease;
  }
  
  #finalScore h2 {
    color: #667eea;
    margin-bottom: 20px;
    font-size: 36px;
  }
  
  .final-grade {
    font-size: 72px;
    font-weight: 800;
    margin: 25px 0;
    animation: bounce 1s ease infinite;
  }
  
  .badge-container {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin: 20px 0;
    flex-wrap: wrap;
  }
  
  .achievement-badge {
    padding: 10px 20px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 16px;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    animation: fadeInScale 0.8s ease;
  }
  
  .badge-gold {
    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
    color: #78350f;
    border: 3px solid #d97706;
  }
  
  .badge-silver {
    background: linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%);
    color: #1f2937;
    border: 3px solid #6b7280;
  }
  
  .badge-bronze {
    background: linear-gradient(135deg, #fdba74 0%, #fb923c 100%);
    color: #7c2d12;
    border: 3px solid #ea580c;
  }
  
  .grade-good { color: var(--easy); }
  .grade-bad { color: var(--hard); }
  
  #finalMessage {
    font-size: 18px;
    line-height: 1.6;
    margin: 20px 0;
    color: var(--text-secondary);
  }
  
  /* Calculator Styles */
  .calc-card {
    background: var(--card);
    border-radius: 25px;
    padding: 40px;
    box-shadow: var(--shadow);
    margin-bottom: 30px;
  }
  
  .calc-section {
    margin-bottom: 30px;
  }
  
  .calc-section h3 {
    font-size: 24px;
    font-weight: 800;
    color: #667eea;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .input-group {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    max-width: 100%;
    gap: 20px;
    margin-bottom: 20px;
  }
  
  /* Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù‚ÙˆÙ„ 2 Ø£Ùˆ 3ØŒ Ø§Ø¬Ø¹Ù„Ù‡Ù… ÙÙŠ ØµÙ ÙˆØ§Ø­Ø¯ */
  .input-group:has(.input-field:nth-child(2):last-child) {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .input-group:has(.input-field:nth-child(3):last-child) {
    grid-template-columns: repeat(3, 1fr);
  }
  
  /* Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù‚ÙˆÙ„ 4 Ø£Ùˆ Ø£ÙƒØ«Ø±ØŒ Ø­Ø¯ Ø£Ù‚ØµÙ‰ 4 ÙÙŠ Ø§Ù„ØµÙ */
  .input-group:has(.input-field:nth-child(4)) {
    grid-template-columns: repeat(4, 1fr);
  }
  
  @media (max-width: 968px) {
    .input-group {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  @media (max-width: 640px) {
    .input-group {
      grid-template-columns: 1fr;
    }
  }
  
  .input-field {
    display: flex;
    flex-direction: column;
  }
  
  .input-field label {
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 8px;
    font-size: 16px;
  }
  
  .input-field input, .input-field select {
    padding: 12px 15px;
    border: 2px solid #e5e7eb;
    border-radius: 10px;
    font-size: 16px;
    font-family: inherit;
    transition: all 0.3s;
  }
  
  .input-field input:focus, .input-field select:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  .calc-button {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 15px 40px;
    font-size: 18px;
    font-weight: 800;
    border-radius: 15px;
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
    transition: all 0.3s ease;
    font-family: inherit;
  }
  
  .calc-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
  }
  
  .results-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin-top: 30px;
  }
  
  .result-card {
    background: linear-gradient(135deg, #f0f4ff 0%, #f9f0ff 100%);
    border-radius: 15px;
    padding: 20px;
    border: 2px solid #e0e7ff;
  }
  
  .result-card h4 {
    font-size: 18px;
    font-weight: 800;
    color: #667eea;
    margin-bottom: 10px;
  }
  
  .result-card p {
    font-size: 16px;
    color: var(--text-primary);
    line-height: 1.6;
  }
  
  .result-value {
    font-size: 24px;
    font-weight: 800;
    color: #764ba2;
    margin-top: 5px;
  }
  
  .calc-chart-wrapper {
    background: var(--card);
    border-radius: 15px;
    border: 2px solid #e5e7eb;
    padding: 20px;
    margin-top: 30px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
  }
  
  [data-theme="dark"] .calc-chart-wrapper {
    border-color: #475569;
  }
  
  #calcChart {
    width: 100% !important;
    height: 400px !important;
  }
  
  @media (max-width: 900px) {
    .quiz-wrapper {
      flex-direction: column;
    }
    
    .side-progress {
      width: 100%;
      height: auto;
      flex-direction: row;
      padding: 15px;
      position: relative;
      justify-content: center;
      gap: 15px;
    }
    
    .progress-percentage {
      width: 60px;
      min-width: 60px;
      height: 60px;
      min-height: 60px;
      font-size: 16px;
      margin-bottom: 0;
      flex-shrink: 0;
    }
    
    .progress-steps {
      flex-direction: row;
      gap: 10px;
      justify-content: center;
    }
    
    .progress-step {
      width: 40px;
      height: 40px;
      font-size: 14px;
    }
    
    .qcard {
      grid-template-columns: 1fr;
      padding: 20px;
    }
    
    /* ØªØµØºÙŠØ± Ø§Ù„Ø³Ø¤Ø§Ù„ Ù„Ù„Ø¬ÙˆØ§Ù„ */
    .funcTitle {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .asks {
      font-size: 14px;
      padding: 10px;
      margin-bottom: 12px;
    }
    
    .chart-wrapper {
      padding: 8px;
      margin-bottom: 10px;
    }
    
    canvas {
      height: 220px !important;
    }
    
    .opt {
      padding: 14px 16px;
      font-size: 15px;
    }
    
    .btn-hint {
      padding: 10px 16px;
      font-size: 14px;
      margin-top: 12px;
    }
    
    .explanation-box {
      padding: 15px;
      font-size: 14px;
      margin-top: 15px;
    }
    
    .explanation-title {
      font-size: 15px;
    }
    
    .explanation-content {
      font-size: 14px;
    }
    
    .explanation-steps {
      padding: 10px;
      font-size: 13px;
    }
    
    /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
    .hero-card {
      padding: 30px 20px;
    }
    
    .math-icons {
      font-size: 40px;
      margin-bottom: 15px;
      letter-spacing: 8px;
    }
    
    .hero-title {
      font-size: 26px;
      margin-bottom: 10px;
    }
    
    .hero-subtitle {
      font-size: 18px;
      margin-bottom: 20px;
    }
    
    .project-info {
      padding: 20px;
      margin: 20px 0;
    }
    
    .author-name {
      font-size: 22px;
      margin-bottom: 8px;
    }
    
    .project-details {
      font-size: 14px;
      line-height: 1.6;
    }
    
    .start-btn, .calc-btn {
      padding: 16px 40px;
      font-size: 18px;
      margin: 8px;
    }
    
    /* ØµÙØ­Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰ */
    .page-header h1 {
      font-size: 28px;
    }
    
    .page-header p {
      font-size: 16px;
    }
    
    .levels-grid {
      gap: 20px;
      margin-top: 25px;
    }
    
    .level-card {
      padding: 30px 20px;
      min-width: 240px;
    }
    
    .level-icon {
      width: 90px;
      height: 90px;
      margin-bottom: 20px;
    }
    
    .level-title {
      font-size: 26px;
      margin-bottom: 12px;
    }
    
    .level-desc {
      font-size: 14px;
      margin-bottom: 15px;
    }
    
    .level-badge {
      padding: 6px 16px;
      font-size: 13px;
    }
    
    /* ØµÙØ­Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆØ§Ù„ - ØµÙÙŠÙ† */
    .functions-grid {
      grid-template-columns: repeat(2, 1fr) !important;
      gap: 15px;
      margin-top: 25px;
    }
    
    .function-card {
      padding: 20px 15px;
    }
    
    .function-icon {
      font-size: 45px;
      margin-bottom: 12px;
    }
    
    .function-card h3 {
      font-size: 18px;
      margin-bottom: 6px;
    }
    
    .function-card p {
      font-size: 12px;
      margin-bottom: 12px;
    }
    
    .function-formula {
      padding: 12px;
      font-size: 15px;
    }
    
    /* Ø±Ø£Ø³ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± */
    .quiz-header {
      flex-wrap: wrap;
      padding: 18px 20px;
      margin-bottom: 20px;
    }
    
    .quiz-title {
      width: 100%;
      text-align: center;
      margin-bottom: 12px;
      font-size: 22px;
    }
    
    .quiz-meta {
      width: 100%;
      justify-content: center;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .timer-badge, .score-badge {
      padding: 8px 14px;
      font-size: 13px;
    }
    
    .streak-badge {
      padding: 6px 12px;
      font-size: 13px;
    }
    
    .back-btn {
      padding: 8px 14px;
      font-size: 13px;
    }
    
    /* Ø§Ù„Ø­Ø§Ø³Ø¨Ø© */
    .calc-card {
      padding: 25px 20px;
    }
    
    .calc-section h3 {
      font-size: 20px;
      margin-bottom: 15px;
    }
    
    #formulaDisplay {
      font-size: 22px;
    }
    
    .input-group {
      grid-template-columns: 1fr;
      gap: 15px;
    }
    
    .input-field label {
      font-size: 14px;
      margin-bottom: 6px;
    }
    
    .input-field input, .input-field select {
      padding: 10px 12px;
      font-size: 14px;
    }
    
    .calc-button {
      padding: 12px 30px;
      font-size: 16px;
    }
    
    .results-grid {
      grid-template-columns: 1fr;
      gap: 15px;
    }
    
    .result-card {
      padding: 15px;
    }
    
    .result-card h4 {
      font-size: 16px;
      margin-bottom: 8px;
    }
    
    .result-card p {
      font-size: 14px;
    }
    
    .result-value {
      font-size: 20px;
    }
    
    /* Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© */
    #finalScore {
      padding: 30px 20px;
      max-width: 90%;
    }
    
    #finalScore h2 {
      font-size: 28px;
      margin-bottom: 15px;
    }
    
    .final-grade {
      font-size: 56px;
      margin: 20px 0;
    }
    
    .achievement-badge {
      padding: 8px 16px;
      font-size: 14px;
    }
    
    #finalMessage {
      font-size: 16px;
      margin: 15px 0;
    }
    
    .btn-finish {
      padding: 15px;
      font-size: 18px;
      margin-top: 20px;
    }
  }
  
  /* Ù„Ù„Ø¬ÙˆØ§Ù„Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
  @media (max-width: 480px) {
    .functions-grid {
      grid-template-columns: 1fr !important;
    }
    
    .hero-title {
      font-size: 22px;
    }
    
    .hero-subtitle {
      font-size: 16px;
    }
    
    .math-icons {
      font-size: 35px;
    }
    
    .level-card {
      min-width: 100%;
    }
    
    .page-header h1 {
      font-size: 24px;
    }
    
    .quiz-title {
      font-size: 20px;
    }
    
    .funcTitle {
      font-size: 15px;
    }
    
    .asks {
      font-size: 13px;
    }
    
    .opt {
      padding: 12px 14px;
      font-size: 14px;
    }
  }
</style>
</head>
<body>

<!-- Ø²Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­ ÙˆØ§Ù„Ø¯Ø§ÙƒÙ† -->
<button class="theme-toggle" onclick="toggleTheme()" id="themeToggle">
  <span class="icon">ğŸŒ™</span>
  <span id="themeText">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†</span>
</button>

<div id="startPage" class="page-section active">
  <div class="hero-card">
    <div class="math-icons">
      <span style="display: inline-block; animation: bounce 2s infinite;">ğŸ“</span>
      <span style="display: inline-block; animation: bounce 2s 0.2s infinite;">ğŸ“</span>
      <span style="display: inline-block; animation: bounce 2s 0.4s infinite;">ğŸ“Š</span>
      <span style="display: inline-block; animation: bounce 2s 0.6s infinite;">ğŸ“ˆ</span>
      <span style="display: inline-block; animation: bounce 2s 0.8s infinite;">âˆ</span>
    </div>
    <h1 class="hero-title">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ù‘ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ</h1>
    <p class="hero-subtitle">Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ â€¢ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„</p>
    
    <div class="project-info">
      <div class="author-name">ğŸ‘¤ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø·Ø§Ù„Ø¨: ÙŠØ²Ù† (Yazan)</div>
      <div class="project-details">
        ğŸ“š Ø§Ù„Ù…Ø§Ø¯Ø©: Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª - Ø¯Ø±Ø³ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ©<br>
        ğŸ¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: 24 Ø³Ø¤Ø§Ù„ (8 Ù„ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰)<br>
        â° Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­: 20 Ø¯Ù‚ÙŠÙ‚Ø©<br>
        ğŸ† Ø§Ù„Ù‡Ø¯Ù: Ø§Ø®ØªØ¨Ø§Ø± ÙÙ‡Ù…Ùƒ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ©<br>
        ğŸ§® Ø­Ø§Ø³Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ø­Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ ÙˆØªØ­Ù„ÙŠÙ„ Ø®ØµØ§Ø¦ØµÙ‡Ø§
      </div>
    </div>
    
    <button class="start-btn" onclick="goToLevelSelection()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢Ù† ğŸš€</button>
    <button class="calc-btn" onclick="goToFunctionSelection()">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ© ğŸ§®</button>
  </div>
</div>

<div id="levelPage" class="page-section">
  <div class="level-container">
    <div class="page-header">
      <h1>Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø© ğŸ¯</h1>
      <p>ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 8 Ø£Ø³Ø¦Ù„Ø© Ù…ØªÙ†ÙˆØ¹Ø©</p>
    </div>
    
    <div class="levels-grid">
      <div class="level-card easy" onclick="startQuiz('easy')">
        <div class="level-icon"></div>
        <h2 class="level-title">Ø³Ù‡Ù„</h2>
        <p class="level-desc">Ù…ÙØ§Ù‡ÙŠÙ… Ø£Ø³Ø§Ø³ÙŠØ©: Ø§Ù„Ù…Ø¬Ø§Ù„ØŒ Ø§Ù„Ù…Ø¯Ù‰ØŒ Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø§Ù„Ø©ØŒ ÙˆØ§Ù„Ø¥Ø²Ø§Ø­Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</p>
        <span class="level-badge">8 Ø£Ø³Ø¦Ù„Ø©</span>
      </div>
      
      <div class="level-card medium" onclick="startQuiz('medium')">
        <div class="level-icon"></div>
        <h2 class="level-title">Ù…ØªÙˆØ³Ø·</h2>
        <p class="level-desc">ØªØ­Ù„ÙŠÙ„ Ø£Ø¹Ù…Ù‚: Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ØŒ Ø§Ù„Ø¥Ø²Ø§Ø­Ø§Øª Ø§Ù„Ù…Ø±ÙƒØ¨Ø©ØŒ ÙˆÙ…Ù‚Ø§Ø·Ø¹ Ø§Ù„Ù…Ø­Ø§ÙˆØ±</p>
        <span class="level-badge">8 Ø£Ø³Ø¦Ù„Ø©</span>
      </div>
      
      <div class="level-card hard" onclick="startQuiz('hard')">
        <div class="level-icon"></div>
        <h2 class="level-title">ØµØ¹Ø¨</h2>
        <p class="level-desc">ØªØ­Ø¯ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©: Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³ØŒ Ø§Ù„ØªÙ…Ø¯Ø¯ØŒ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©</p>
        <span class="level-badge">8 Ø£Ø³Ø¦Ù„Ø©</span>
      </div>
    </div>
    
    <div style="text-align: center; margin-top: 30px;">
      <button class="calc-btn" onclick="goToFunctionSelection()">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ© ğŸ§®</button>
      <button class="back-btn" onclick="goToStart()">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©</button>
    </div>
  </div>
</div>

<!-- ØµÙØ­Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆØ§Ù„ -->
<div id="functionSelectionPage" class="page-section">
  <div class="level-container">
    <div class="page-header">
      <h1>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø§Ù„Ø© ğŸ“Š</h1>
      <p>Ø§Ø®ØªØ± Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙƒØ´Ø§ÙÙ‡Ø§ ÙˆØ­Ø³Ø§Ø¨ Ø®ØµØ§Ø¦ØµÙ‡Ø§</p>
    </div>
    
    <div class="functions-grid">
      <!-- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ© -->
      <div class="function-card" onclick="selectFunction('exponential')">
        <div class="function-icon">ğŸ“ˆ</div>
        <h3>Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ©</h3>
        <p>Exponential Functions</p>
        <div class="function-formula">f(x) = aÂ·b<sup>(xÂ±h)</sup> Â± k</div>
      </div>
      
      <!-- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø®Ø·ÙŠØ© -->
      <div class="function-card" onclick="selectFunction('linear')">
        <div class="function-icon">ğŸ“</div>
        <h3>Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø®Ø·ÙŠØ©</h3>
        <p>Linear Functions</p>
        <div class="function-formula">f(x) = mx + b</div>
      </div>
      
      <!-- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠØ© -->
      <div class="function-card" onclick="selectFunction('quadratic')">
        <div class="function-icon">ğŸ”·</div>
        <h3>Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠØ©</h3>
        <p>Quadratic Functions</p>
        <div class="function-formula">f(x) = a(x-h)Â² + k</div>
      </div>
      
      <!-- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠØ© -->
      <div class="function-card" onclick="selectFunction('cubic')">
        <div class="function-icon">ğŸ”¶</div>
        <h3>Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠØ©</h3>
        <p>Cubic Functions</p>
        <div class="function-formula">f(x) = a(x-h)Â³ + k</div>
      </div>
      
      <!-- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ -->
      <div class="function-card" onclick="selectFunction('sqrt')">
        <div class="function-icon">âˆš</div>
        <h3>Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ</h3>
        <p>Square Root Function</p>
        <div class="function-formula">f(x) = aâˆš(x-h) + k</div>
      </div>
      
      <!-- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠ -->
      <div class="function-card" onclick="selectFunction('cbrt')">
        <div class="function-icon">âˆ›</div>
        <h3>Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠ</h3>
        <p>Cube Root Function</p>
        <div class="function-formula">f(x) = aâˆ›(x-h) + k</div>
      </div>
      
      <!-- Ø¯Ø§Ù„Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø·Ù„Ù‚Ø© -->
      <div class="function-card" onclick="selectFunction('absolute')">
        <div class="function-icon">ğŸ“</div>
        <h3>Ø¯Ø§Ù„Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©</h3>
        <p>Absolute Value</p>
        <div class="function-formula">f(x) = a|x-h| + k</div>
      </div>
      
      <!-- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù„ÙˆØºØ§Ø±ÙŠØªÙ…ÙŠØ© -->
      <div class="function-card" onclick="selectFunction('logarithm')">
        <div class="function-icon">ğŸ“Š</div>
        <h3>Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù„ÙˆØºØ§Ø±ÙŠØªÙ…ÙŠØ©</h3>
        <p>Logarithmic Functions</p>
        <div class="function-formula">f(x) = aÂ·log<sub>b</sub>(x-h) + k</div>
      </div>
      
      <!-- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬ÙŠØ¨ -->
      <div class="function-card" onclick="selectFunction('sine')">
        <div class="function-icon">ã€°ï¸</div>
        <h3>Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬ÙŠØ¨</h3>
        <p>Sine Function</p>
        <div class="function-formula">f(x) = aÂ·sin(b(x-h)) + k</div>
      </div>
      
      <!-- Ø¯Ø§Ù„Ø© Ø¬ÙŠØ¨ Ø§Ù„ØªÙ…Ø§Ù… -->
      <div class="function-card" onclick="selectFunction('cosine')">
        <div class="function-icon">ã€°ï¸</div>
        <h3>Ø¯Ø§Ù„Ø© Ø¬ÙŠØ¨ Ø§Ù„ØªÙ…Ø§Ù…</h3>
        <p>Cosine Function</p>
        <div class="function-formula">f(x) = aÂ·cos(b(x-h)) + k</div>
      </div>
      
      <!-- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¸Ù„ -->
      <div class="function-card" onclick="selectFunction('tangent')">
        <div class="function-icon">ğŸ“ˆ</div>
        <h3>Ø¯Ø§Ù„Ø© Ø§Ù„Ø¸Ù„</h3>
        <p>Tangent Function</p>
        <div class="function-formula">f(x) = aÂ·tan(b(x-h)) + k</div>
      </div>
      
      <!-- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ÙƒØ³Ø±ÙŠØ© -->
      <div class="function-card" onclick="selectFunction('rational')">
        <div class="function-icon">â—</div>
        <h3>Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ÙƒØ³Ø±ÙŠØ©</h3>
        <p>Rational Functions</p>
        <div class="function-formula">f(x) = a/(x-h) + k</div>
      </div>
    </div>
    
    <div style="text-align: center; margin-top: 30px;">
      <button class="back-btn" onclick="goToLevelSelection()">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø®Ù„Ù</button>
    </div>
  </div>
</div>

<div id="calculatorPage" class="page-section">
  <div class="calc-container">
    <div class="page-header">
      <h1>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ© ğŸ§®</h1>
      <p>Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø¯Ø§Ù„Ø© ÙˆØ´Ø§Ù‡Ø¯ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„</p>
    </div>
    
    <div class="calc-card">
      <div class="calc-section">
        <h3 id="calcTitle">ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ©</h3>
        
        <!-- Ø¹Ø±Ø¶ ØµÙŠØºØ© Ø§Ù„Ø¯Ø§Ù„Ø© Ø¨Ø´ÙƒÙ„ Ø¬Ù…ÙŠÙ„ -->
        <div style="text-align: center; margin: 25px 0; padding: 20px; background: linear-gradient(135deg, #f0f4ff 0%, #f9f0ff 100%); border-radius: 15px; border: 2px solid #e0e7ff;">
          <div style="font-size: 12px; color: #667eea; font-weight: 700; margin-bottom: 10px; letter-spacing: 1px;">ğŸ“ ØµÙŠØºØ© Ø§Ù„Ø¯Ø§Ù„Ø©</div>
          <div id="formulaDisplay" style="font-size: 28px; font-weight: 900; color: #764ba2; font-family: 'Courier New', monospace; letter-spacing: 1px; text-shadow: 1px 1px 2px rgba(0,0,0,0.1);">
            f(x) = a Â· b<sup>(xÂ±h)</sup> Â± k
          </div>
        </div>
        
        <div class="input-group" id="inputsContainer">
          <div class="input-field">
            <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a (Ø§Ù„ØªÙ…Ø¯Ø¯/Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³):</label>
            <input type="number" id="inputA" value="1" step="0.1">
          </div>
          
          <div class="input-field">
            <label>Ø§Ù„Ø£Ø³Ø§Ø³ b (Base):</label>
            <input type="number" id="inputBase" value="2" step="0.1" min="0.01">
          </div>
          
          <div class="input-field">
            <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
            <input type="number" id="inputH" value="0" step="0.5">
          </div>
          
          <div class="input-field">
            <label>Ø¥ØªØ¬Ø§Ù‡ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ©:</label>
            <select id="inputHSign">
              <option value="1">+ (ÙŠØ³Ø§Ø±)</option>
              <option value="-1">- (ÙŠÙ…ÙŠÙ†)</option>
            </select>
          </div>
          
          <div class="input-field">
            <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
            <input type="number" id="inputK" value="0" step="0.5">
          </div>
          
          <div class="input-field">
            <label>Ø¥ØªØ¬Ø§Ù‡ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ©:</label>
            <select id="inputKSign">
              <option value="1">+ (Ø£Ø¹Ù„Ù‰)</option>
              <option value="-1">- (Ø£Ø³ÙÙ„)</option>
            </select>
          </div>
        </div>
        
        <button class="calc-button" onclick="calculateFunction()">Ø­Ø³Ø§Ø¨ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø§Ù„Ø© ğŸ“Š</button>
      </div>
      
      <div id="resultsSection" style="display: none;">
        <div class="calc-section">
          <h3>ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„</h3>
          
          <div id="functionDisplay" style="text-align: center; font-size: 24px; font-weight: 800; color: #764ba2; padding: 15px; background: #f9f0ff; border-radius: 15px; margin-bottom: 20px; border: 3px solid #e0e7ff;">
          </div>
          
          <div class="results-grid">
            <div class="result-card">
              <h4>ğŸ¯ Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø§Ù„Ø©</h4>
              <p id="resultType"></p>
            </div>
            
            <div class="result-card">
              <h4>ğŸ“ Ø§Ù„Ù…Ø¬Ø§Ù„</h4>
              <p id="resultDomain" class="result-value"></p>
            </div>
            
            <div class="result-card">
              <h4>ğŸ“ Ø§Ù„Ù…Ø¯Ù‰</h4>
              <p id="resultRange" class="result-value"></p>
            </div>
            
            <div class="result-card">
              <h4>â– Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠ</h4>
              <p id="resultAsymptote" class="result-value"></p>
            </div>
            
            <div class="result-card">
              <h4>â†”ï¸ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ©</h4>
              <p id="resultHShift" class="result-value"></p>
            </div>
            
            <div class="result-card">
              <h4>â†•ï¸ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ©</h4>
              <p id="resultVShift" class="result-value"></p>
            </div>
            
            <div class="result-card">
              <h4>ğŸ“ Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…Ø­ÙˆØ± y</h4>
              <p id="resultYIntercept" class="result-value"></p>
            </div>
            
            <div class="result-card">
              <h4>ğŸ”„ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª</h4>
              <p id="resultTransformations"></p>
            </div>
          </div>
          
          <div class="calc-chart-wrapper">
            <canvas id="calcChart"></canvas>
          </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ¹ÙˆÙŠØ¶ ÙˆØ­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø© -->
        <div class="calc-section" style="margin-top: 30px;">
          <h3>ğŸ”¢ Ø§Ù„ØªØ¹ÙˆÙŠØ¶ ÙˆØ­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ…Ø©</h3>
          <p style="color: #666; margin-bottom: 15px;">Ø£Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© x Ù„Ø­Ø³Ø§Ø¨ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯Ø§Ù„Ø© f(x) Ù…Ø¹ Ø¹Ø±Ø¶ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„</p>
          
          <div style="display: flex; gap: 15px; align-items: end; margin-bottom: 20px;">
            <div class="input-field" style="flex: 1;">
              <label>Ù‚ÙŠÙ…Ø© x:</label>
              <input type="number" id="inputXValue" value="2" step="0.5">
            </div>
            <button class="calc-button" onclick="calculateSubstitution()" style="flex: 0 0 auto;">Ø­Ø³Ø§Ø¨ f(x) ğŸ¯</button>
          </div>
          
          <div id="substitutionResult" style="display: none;">
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
              <h4 style="margin: 0 0 15px 0; font-size: 20px;">ğŸ“ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©:</h4>
              <div id="stepByStep" style="line-height: 2; font-size: 16px;"></div>
              <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid rgba(255,255,255,0.3);">
                <h4 style="margin: 0 0 10px 0; font-size: 18px;">ğŸ¯ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</h4>
                <div id="finalResult" style="font-size: 32px; font-weight: 900; text-align: center;"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div style="text-align: center; margin-top: 30px;">
      <button class="back-btn" onclick="backToLevelSelection()">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø®Ù„Ù</button>
    </div>
  </div>
</div>

<div id="quizPage" class="page-section">
  <div class="quiz-wrapper">
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
    <div class="side-progress">
      <div class="progress-percentage" id="progressPercentage">0%</div>
      <div class="progress-steps" id="progressSteps">
        <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¯ÙˆØ§Ø¦Ø± Ø§Ù„Ø«Ù…Ø§Ù†ÙŠØ© Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
      </div>
    </div>
    
    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="quiz-container">
      <div class="quiz-header">
        <div class="quiz-title" id="quizTitle">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰</div>
        <div class="quiz-meta">
          <div class="streak-badge" id="streakBadge">ğŸ”¥ <span id="streakCount">0</span> Ù…ØªØªØ§Ù„ÙŠØ©</div>
          <div class="timer-badge" id="timerBadge">â±ï¸ <span id="timerDisplay">20:00</span></div>
          <div class="score-badge">Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="currentScore">0</span> / 8</div>
          <button type="button" class="back-btn" id="backButton">â† Ø±Ø¬ÙˆØ¹</button>
        </div>
      </div>
      
      <div class="encouragement-msg" id="encouragementMsg"></div>
      
      <div id="questionsContainer"></div>
      
      <button id="finishBtn" class="btn-finish" onclick="showFinalScore()">Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ±Ø¤ÙŠØ© Ø§Ù„Ù†ØªÙŠØ¬Ø© ğŸ†</button>
    </div>
  </div>
</div>

<div id="finalScore">
  <h2>Ù†ØªÙŠØ¬ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ğŸ‰</h2>
  <p>Ù„Ù‚Ø¯ Ø£Ø¬Ø¨Øª Ø¹Ù„Ù‰:</p>
  <div class="final-grade" id="finalGradeText"></div>
  <div class="badge-container" id="badgeContainer"></div>
  <p id="finalMessage"></p>
  <button class="btn-hint" onclick="resetAndBackToLevels()">Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø¢Ø®Ø±</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script src="app.js"></script>

</body>
</html>
  <script>
// ==================== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ====================
let currentLevel = '';
let currentScore = 0;
let currentQuestionIndex = 0;
let selectedAnswer = null;
let timerInterval = null;
let totalTime = 1200; // 20 Ø¯Ù‚ÙŠÙ‚Ø©
let currentStreak = 0;
let selectedFunction = 'exponential';
let calcChart = null;

// ==================== ÙˆØ¸Ø§Ø¦Ù ÙˆØ¶Ø¹ Ø§Ù„Ø¸Ù„Ø§Ù… ====================
function toggleTheme() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
  
  document.documentElement.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
  
  const icon = document.querySelector('#themeToggle .icon');
  const text = document.querySelector('#themeText');
  
  if (newTheme === 'dark') {
    icon.textContent = 'â˜€ï¸';
    text.textContent = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­';
  } else {
    icon.textContent = 'ğŸŒ™';
    text.textContent = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†';
  }
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸ Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
function loadTheme() {
  const savedTheme = localStorage.getItem('theme') || 'light';
  document.documentElement.setAttribute('data-theme', savedTheme);
  
  const icon = document.querySelector('#themeToggle .icon');
  const text = document.querySelector('#themeText');
  
  if (savedTheme === 'dark') {
    icon.textContent = 'â˜€ï¸';
    text.textContent = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­';
  } else {
    icon.textContent = 'ğŸŒ™';
    text.textContent = 'Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†';
  }
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
window.addEventListener('DOMContentLoaded', loadTheme);

// ==================== Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ====================
const questionsBank = {
  easy: [
    {
      func: "f(x) = 2^x",
      asks: "Ù…Ø§ Ù†ÙˆØ¹ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø©", "Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ©", "Ø¯Ø§Ù„Ø© Ø®Ø·ÙŠØ©", "Ø¯Ø§Ù„Ø© ØªØ±Ø¨ÙŠØ¹ÙŠØ©"],
      correct: 0,
      explanation: "Ø§Ù„Ø¯Ø§Ù„Ø© f(x) = 2^x Ù‡ÙŠ Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø© Ù„Ø£Ù† Ø§Ù„Ø£Ø³Ø§Ø³ 2 Ø£ÙƒØ¨Ø± Ù…Ù† 1.",
      steps: "Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ b > 1ØŒ ØªÙƒÙˆÙ† Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø©."
    },
    {
      func: "f(x) = (1/2)^x",
      asks: "Ù…Ø§ Ù†ÙˆØ¹ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ©", "Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø©", "Ø¯Ø§Ù„Ø© Ø«Ø§Ø¨ØªØ©", "Ø¯Ø§Ù„Ø© ÙƒØ³Ø±ÙŠØ©"],
      correct: 0,
      explanation: "Ø§Ù„Ø¯Ø§Ù„Ø© f(x) = (1/2)^x Ù‡ÙŠ Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ© Ù„Ø£Ù† Ø§Ù„Ø£Ø³Ø§Ø³ 1/2 Ø£Ù‚Ù„ Ù…Ù† 1.",
      steps: "Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ 0 < b < 1ØŒ ØªÙƒÙˆÙ† Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ©."
    },
    {
      func: "f(x) = 3^x",
      asks: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¬Ø§Ù„ (Domain) Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (â„)", "x > 0", "x â‰¥ 0", "x â‰  0"],
      correct: 0,
      explanation: "Ù…Ø¬Ø§Ù„ Ø£ÙŠ Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù‡Ùˆ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©.",
      steps: "Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© Ù…Ø¹Ø±ÙØ© Ù„Ø¬Ù…ÙŠØ¹ Ù‚ÙŠÙ… x Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©."
    },
    {
      func: "f(x) = 2^x",
      asks: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¯Ù‰ (Range) Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["y > 0", "y â‰¥ 0", "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©", "y < 0"],
      correct: 0,
      explanation: "Ù…Ø¯Ù‰ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© f(x) = 2^x Ù‡Ùˆ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙˆØ¬Ø¨Ø© (y > 0).",
      steps: "Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…ÙˆØ¬Ø¨Ø©ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªØ³Ø§ÙˆÙŠ Ø£Ùˆ ØªÙ‚Ù„ Ø¹Ù† ØµÙØ±."
    },
    {
      func: "f(x) = 2^x + 3",
      asks: "Ù…Ø§ Ù‡Ùˆ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠØŸ",
      options: ["y = 3", "y = 0", "y = 2", "x = 3"],
      correct: 0,
      explanation: "Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠ Ù‡Ùˆ y = 3 Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© +3.",
      steps: "ÙÙŠ Ø§Ù„Ø¯Ø§Ù„Ø© f(x) = 2^x + kØŒ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠ Ù‡Ùˆ y = k."
    },
    {
      func: "f(x) = 2^(x-1)",
      asks: "ÙƒÙ… Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ©ØŸ",
      options: ["1 ÙˆØ­Ø¯Ø© Ù„Ù„ÙŠÙ…ÙŠÙ†", "1 ÙˆØ­Ø¯Ø© Ù„Ù„ÙŠØ³Ø§Ø±", "2 ÙˆØ­Ø¯Ø© Ù„Ù„ÙŠÙ…ÙŠÙ†", "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©"],
      correct: 0,
      explanation: "Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© Ù‡ÙŠ 1 ÙˆØ­Ø¯Ø© Ù„Ù„ÙŠÙ…ÙŠÙ† Ø¨Ø³Ø¨Ø¨ (x-1).",
      steps: "ÙÙŠ Ø§Ù„ØµÙŠØºØ© f(x) = b^(x-h)ØŒ Ø§Ù„Ø¯Ø§Ù„Ø© ØªÙ†Ø²Ø§Ø­ h ÙˆØ­Ø¯Ø§Øª Ù„Ù„ÙŠÙ…ÙŠÙ†."
    },
    {
      func: "f(x) = 2^x - 5",
      asks: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¯Ù‰ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["y > -5", "y > 0", "y < -5", "y â‰¥ -5"],
      correct: 0,
      explanation: "Ø§Ù„Ù…Ø¯Ù‰ Ù‡Ùˆ y > -5 Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© -5.",
      steps: "Ø§Ù„Ø¯Ø§Ù„Ø© 2^x Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…ÙˆØ¬Ø¨Ø© (> 0)ØŒ ÙØ¹Ù†Ø¯ Ø·Ø±Ø­ 5 ÙŠØµØ¨Ø­ Ø§Ù„Ù…Ø¯Ù‰ y > -5."
    },
    {
      func: "f(x) = 3^x",
      asks: "Ù…Ø§ Ù‚ÙŠÙ…Ø© f(0)ØŸ",
      options: ["1", "0", "3", "ØºÙŠØ± Ù…Ø¹Ø±Ù‘Ù"],
      correct: 0,
      explanation: "f(0) = 3^0 = 1ØŒ Ù„Ø£Ù† Ø£ÙŠ Ø¹Ø¯Ø¯ Ù…Ø±ÙÙˆØ¹ Ù„Ù„Ù‚ÙˆØ© ØµÙØ± ÙŠØ³Ø§ÙˆÙŠ 1.",
      steps: "Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: a^0 = 1 Ù„Ø£ÙŠ Ø¹Ø¯Ø¯ a â‰  0."
    }
  ],
  medium: [
    {
      func: "f(x) = 2Â·3^(x+2) - 1",
      asks: "Ù…Ø§ Ù‡Ùˆ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠØŸ",
      options: ["y = -1", "y = 0", "y = 2", "y = 1"],
      correct: 0,
      explanation: "Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠ Ù‡Ùˆ y = -1 Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k = -1.",
      steps: "ÙÙŠ f(x) = aÂ·b^(xÂ±h) Â± kØŒ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ù‡Ùˆ y = k."
    },
    {
      func: "f(x) = -(2^x)",
      asks: "Ù…Ø§ Ù†ÙˆØ¹ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ© Ù…Ø¹ Ø§Ù†Ø¹ÙƒØ§Ø³", "Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø©", "Ø¯Ø§Ù„Ø© Ø®Ø·ÙŠØ©", "Ø¯Ø§Ù„Ø© ØªØ±Ø¨ÙŠØ¹ÙŠØ©"],
      correct: 0,
      explanation: "Ø§Ù„Ø¯Ø§Ù„Ø© f(x) = -2^x Ù‡ÙŠ Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ© Ù…Ø¹ Ø§Ù†Ø¹ÙƒØ§Ø³ Ø­ÙˆÙ„ Ø§Ù„Ù…Ø­ÙˆØ± x Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø³Ø§Ù„Ø¨Ø©.",
      steps: "Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø³Ø§Ù„Ø¨ ÙŠØ¹ÙƒØ³ Ø§Ù„Ø¯Ø§Ù„Ø© Ø­ÙˆÙ„ Ø§Ù„Ù…Ø­ÙˆØ± xØŒ ÙˆØ§Ù„Ø£Ø³Ø§Ø³ 2 > 1 ÙŠØ¬Ø¹Ù„Ù‡Ø§ Ù…ØªØ²Ø§ÙŠØ¯Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³."
    },
    {
      func: "f(x) = 3^(x-2) + 4",
      asks: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© ÙˆØ§Ù„Ø±Ø£Ø³ÙŠØ©ØŸ",
      options: ["2 ÙŠÙ…ÙŠÙ†ØŒ 4 Ø£Ø¹Ù„Ù‰", "2 ÙŠØ³Ø§Ø±ØŒ 4 Ø£Ø³ÙÙ„", "2 Ø£Ø³ÙÙ„ØŒ 4 ÙŠÙ…ÙŠÙ†", "4 ÙŠÙ…ÙŠÙ†ØŒ 2 Ø£Ø¹Ù„Ù‰"],
      correct: 0,
      explanation: "Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© 2 ÙˆØ­Ø¯Ø© Ù„Ù„ÙŠÙ…ÙŠÙ† (x-2)ØŒ ÙˆØ§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© 4 ÙˆØ­Ø¯Ø§Øª Ù„Ø£Ø¹Ù„Ù‰ (+4).",
      steps: "ÙÙŠ f(x) = b^(x-h) + k: h = 2 (ÙŠÙ…ÙŠÙ†)ØŒ k = 4 (Ø£Ø¹Ù„Ù‰)."
    },
    {
      func: "f(x) = (1/3)^x + 2",
      asks: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø¯Ù‰ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["y > 2", "y < 2", "y â‰¥ 2", "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©"],
      correct: 0,
      explanation: "Ø§Ù„Ù…Ø¯Ù‰ Ù‡Ùˆ y > 2 Ù„Ø£Ù† Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…ÙˆØ¬Ø¨Ø©ØŒ ÙˆØ¨Ø¥Ø¶Ø§ÙØ© 2 ØªØµØ¨Ø­ Ø£ÙƒØ¨Ø± Ù…Ù† 2.",
      steps: "(1/3)^x > 0ØŒ Ø¥Ø°Ø§Ù‹ (1/3)^x + 2 > 2."
    },
    {
      func: "f(x) = 2^(x+1)",
      asks: "Ù…Ø§ Ù‚ÙŠÙ…Ø© f(0)ØŸ",
      options: ["2", "1", "3", "0"],
      correct: 0,
      explanation: "f(0) = 2^(0+1) = 2^1 = 2.",
      steps: "Ø§Ù„ØªØ¹ÙˆÙŠØ¶: x = 0 â†’ f(0) = 2^(0+1) = 2^1 = 2."
    },
    {
      func: "f(x) = 4^x",
      asks: "Ù…Ø§ Ù‚ÙŠÙ…Ø© f(1/2)ØŸ",
      options: ["2", "4", "1", "16"],
      correct: 0,
      explanation: "f(1/2) = 4^(1/2) = âˆš4 = 2.",
      steps: "4^(1/2) ÙŠØ¹Ù†ÙŠ Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ Ù„Ù„Ø¹Ø¯Ø¯ 4ØŒ ÙˆÙ‡Ùˆ 2."
    },
    {
      func: "f(x) = 3Â·(2^x) - 5",
      asks: "Ù…Ø§ Ù‡Ùˆ Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…Ø­ÙˆØ± yØŸ",
      options: ["(-2, 0)", "(-5, 0)", "(3, 0)", "(0, 0)"],
      correct: 0,
      explanation: "Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…Ø­ÙˆØ± y ÙŠØ­Ø³Ø¨ Ø¹Ù†Ø¯ x = 0: f(0) = 3Â·2^0 - 5 = 3Â·1 - 5 = -2ØŒ Ø§Ù„Ù†Ù‚Ø·Ø© Ù‡ÙŠ (-2, 0).",
      steps: "Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = 0: f(0) = 3(1) - 5 = -2ØŒ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠ Ù‡Ùˆ (-2, 0)."
    },
    {
      func: "f(x) = 5^(x-3) + 1",
      asks: "Ù…Ø§ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠ ÙˆØ§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ©ØŸ",
      options: ["y = 1ØŒ 3 ÙŠÙ…ÙŠÙ†", "y = 3ØŒ 1 ÙŠÙ…ÙŠÙ†", "y = 0ØŒ 3 ÙŠÙ…ÙŠÙ†", "y = 1ØŒ 3 ÙŠØ³Ø§Ø±"],
      correct: 0,
      explanation: "Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ y = 1 Ù…Ù† kØŒ ÙˆØ§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© 3 ÙˆØ­Ø¯Ø§Øª Ù„Ù„ÙŠÙ…ÙŠÙ† Ù…Ù† (x-3).",
      steps: "k = 1 â†’ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ y = 1ØŒ h = 3 â†’ Ø¥Ø²Ø§Ø­Ø© 3 ÙŠÙ…ÙŠÙ†."
    }
  ],
  hard: [
    {
      func: "f(x) = -2Â·((1/2)^(x+3)) + 4",
      asks: "Ø­Ù„Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©:",
      options: [
        "Ø§Ù†Ø¹ÙƒØ§Ø³ØŒ ØªÙ…Ø¯Ø¯ Ø±Ø£Ø³ÙŠ Ã—2ØŒ Ø¥Ø²Ø§Ø­Ø© 3 ÙŠØ³Ø§Ø±ØŒ Ø¥Ø²Ø§Ø­Ø© 4 Ø£Ø¹Ù„Ù‰",
        "ØªÙ…Ø¯Ø¯ Ø£ÙÙ‚ÙŠØŒ Ø¥Ø²Ø§Ø­Ø© 3 ÙŠÙ…ÙŠÙ†ØŒ Ø¥Ø²Ø§Ø­Ø© 4 Ø£Ø³ÙÙ„",
        "Ø§Ù†Ø¹ÙƒØ§Ø³ ÙÙ‚Ø·ØŒ Ø¥Ø²Ø§Ø­Ø© 3 ÙŠÙ…ÙŠÙ†",
        "ØªÙ…Ø¯Ø¯ Ø±Ø£Ø³ÙŠ Ã—3ØŒ Ø¥Ø²Ø§Ø­Ø© Ø£ÙÙ‚ÙŠØ© 2"
      ],
      correct: 0,
      explanation: "Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ -2 ÙŠØ¹Ù†ÙŠ Ø§Ù†Ø¹ÙƒØ§Ø³ Ø­ÙˆÙ„ x ÙˆØªÙ…Ø¯Ø¯ Ø±Ø£Ø³ÙŠ Ã—2ØŒ (x+3) Ø¥Ø²Ø§Ø­Ø© 3 ÙŠØ³Ø§Ø±ØŒ +4 Ø¥Ø²Ø§Ø­Ø© 4 Ø£Ø¹Ù„Ù‰.",
      steps: "a = -2: Ø§Ù†Ø¹ÙƒØ§Ø³ ÙˆØªÙ…Ø¯Ø¯ Ã—2ØŒ h = -3: 3 ÙŠØ³Ø§Ø±ØŒ k = 4: 4 Ø£Ø¹Ù„Ù‰."
    },
    {
      func: "f(x) = 0.5Â·(3^(-x)) + 2",
      asks: "Ù…Ø§ Ù†ÙˆØ¹ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ÙˆØ§Ù„Ù…Ø¯Ù‰ØŸ",
      options: [
        "Ù…ØªÙ†Ø§Ù‚ØµØ©ØŒ y > 2",
        "Ù…ØªØ²Ø§ÙŠØ¯Ø©ØŒ y > 0",
        "Ù…ØªÙ†Ø§Ù‚ØµØ©ØŒ y < 2",
        "Ù…ØªØ²Ø§ÙŠØ¯Ø©ØŒ y > 2"
      ],
      correct: 0,
      explanation: "3^(-x) = (1/3)^x Ø¯Ø§Ù„Ø© Ù…ØªÙ†Ø§Ù‚ØµØ©ØŒ ÙˆØ§Ù„Ù…Ø¯Ù‰ y > 2 Ø¨Ø³Ø¨Ø¨ +2.",
      steps: "b^(-x) = (1/b)^xØŒ Ø¥Ø°Ø§ b > 1 ÙÙ€ (1/b) < 1 â†’ Ù…ØªÙ†Ø§Ù‚ØµØ©."
    },
    {
      func: "f(x) = 4Â·(2^(2*x-6)) + 8",
      asks: "Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø¨ØµÙŠØºØ© f(x) = aÂ·b^(x-h) + k:",
      options: [
        "f(x) = 64Â·2^(2x-6) + 8",
        "f(x) = 4Â·4^(x-3) + 8",
        "f(x) = 2Â·2^(x-3) + 8",
        "f(x) = 4Â·2^(x-6) + 8"
      ],
      correct: 1,
      explanation: "2^(2x-6) = 2^(2(x-3)) = (2^2)^(x-3) = 4^(x-3)ØŒ Ø¥Ø°Ø§Ù‹ f(x) = 4Â·4^(x-3) + 8.",
      steps: "Ù†Ø³ØªØ®Ø±Ø¬ 2 ÙƒØ¹Ø§Ù…Ù„ Ù…Ø´ØªØ±Ùƒ: 2x-6 = 2(x-3)ØŒ Ø«Ù…: 2^(2(x-3)) = 4^(x-3)."
    },
    {
      func: "f(x) = -3Â·((1/4)^(x-2)) + 5",
      asks: "Ù…Ø§ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ ÙˆØ§Ù„Ù…Ø¯Ù‰ØŸ",
      options: ["y = 5ØŒ y < 5", "y = 5ØŒ y > 5", "y = -3ØŒ y < -3", "y = 0ØŒ y > 0"],
      correct: 0,
      explanation: "Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ y = 5ØŒ ÙˆØ§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³ ÙŠØ¬Ø¹Ù„ Ø§Ù„Ù…Ø¯Ù‰ y < 5.",
      steps: "k = 5 â†’ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ y = 5ØŒ a = -3 (Ø³Ø§Ù„Ø¨) â†’ Ø§Ù†Ø¹ÙƒØ§Ø³ â†’ y < 5."
    },
    {
      func: "f(x) = 2^(x+1) - 2^x",
      asks: "Ø¨Ø³Ù‘Ø· Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©:",
      options: ["f(x) = 2^x", "f(x) = 2^(2x)", "f(x) = 0", "f(x) = 2"],
      correct: 0,
      explanation: "2^(x+1) = 2Â·2^xØŒ Ø¥Ø°Ø§Ù‹ 2Â·2^x - 2^x = 2^x.",
      steps: "2^(x+1) = 2^x Â· 2^1 = 2Â·2^xØŒ Ø«Ù…: 2Â·2^x - 2^x = 2^x(2-1) = 2^x."
    },
    {
      func: "f(x) = e^x",
      asks: "Ù…Ø§ Ù‚ÙŠÙ…Ø© f'(x) (Ø§Ù„Ù…Ø´ØªÙ‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰)ØŸ",
      options: ["e^x", "xe^(x-1)", "1", "ln(x)"],
      correct: 0,
      explanation: "Ù…Ø´ØªÙ‚Ø© e^x Ù‡ÙŠ e^x Ù†ÙØ³Ù‡Ø§ØŒ ÙˆÙ‡ÙŠ Ø®Ø§ØµÙŠØ© ÙØ±ÙŠØ¯Ø© Ù„Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©.",
      steps: "d/dx(e^x) = e^xØŒ Ù‡Ø°Ù‡ Ø®Ø§ØµÙŠØ© Ù…Ù…ÙŠØ²Ø© Ù„Ù€ e."
    },
    {
      func: "f(x) = 3^x + 3^(-x)",
      asks: "Ù…Ø§ Ù†ÙˆØ¹ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©ØŸ",
      options: ["Ø¯Ø§Ù„Ø© Ø²ÙˆØ¬ÙŠØ© (Even)", "Ø¯Ø§Ù„Ø© ÙØ±Ø¯ÙŠØ© (Odd)", "Ù„Ø§ Ø²ÙˆØ¬ÙŠØ© ÙˆÙ„Ø§ ÙØ±Ø¯ÙŠØ©", "Ø¯Ø§Ù„Ø© Ø®Ø·ÙŠØ©"],
      correct: 0,
      explanation: "f(-x) = 3^(-x) + 3^x = f(x)ØŒ Ø¥Ø°Ø§Ù‹ Ø§Ù„Ø¯Ø§Ù„Ø© Ø²ÙˆØ¬ÙŠØ©.",
      steps: "Ù†Ø®ØªØ¨Ø±: f(-x) = 3^(-x) + 3^(+x) = 3^(-x) + 3^x = f(x) â†’ Ø²ÙˆØ¬ÙŠØ©."
    },
    {
      func: "f(x) = 5Â·(2^(3*x-9)) + 7",
      asks: "Ø£Ø¹Ø¯ ÙƒØªØ§Ø¨Ø© Ø¨Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© ÙˆØ­Ø¯Ø¯ h:",
      options: [
        "f(x) = 40Â·8^(x-3) + 7ØŒ h = 3",
        "f(x) = 5Â·8^(x-3) + 7ØŒ h = 3",
        "f(x) = 5Â·2^(x-9) + 7ØŒ h = 9",
        "f(x) = 15Â·2^(x-3) + 7ØŒ h = 3"
      ],
      correct: 1,
      explanation: "2^(3x-9) = 2^(3(x-3)) = (2^3)^(x-3) = 8^(x-3)ØŒ Ø¥Ø°Ø§Ù‹ h = 3.",
      steps: "Ù†Ø³ØªØ®Ø±Ø¬ 3: 3x-9 = 3(x-3)ØŒ Ø«Ù…: 2^(3(x-3)) = 8^(x-3)ØŒ h = 3."
    }
  ]
};

// ==================== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª ====================
function showPage(pageId) {
  // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
  document.querySelectorAll('.page-section').forEach(p => {
    p.classList.remove('active');
    p.style.display = 'none';
  });
  
  // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
  const targetPage = document.getElementById(pageId);
  targetPage.classList.add('active');
  targetPage.style.display = 'flex';
  
  // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
  window.scrollTo(0, 0);
}

function goToLevelSelection() {
  showPage('levelPage');
}

function goToStart() {
  showPage('startPage');
}

function goToFunctionSelection() {
  showPage('functionSelectionPage');
}

function goToCalculator() {
  selectedFunction = 'exponential';
  setupCalculatorForFunction('exponential');
  showPage('calculatorPage');
}

function selectFunction(funcType) {
  selectedFunction = funcType;
  setupCalculatorForFunction(funcType);
  showPage('calculatorPage');
}

function backToLevelSelection() {
  showPage('levelPage');
}

// ==================== Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ====================
function startQuiz(level) {
  currentLevel = level;
  currentScore = 0;
  currentQuestionIndex = 0;
  currentStreak = 0;
  totalTime = 1200;
  
  const levelNames = {
    easy: 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ù‡Ù„ ğŸŸ¢',
    medium: 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…ØªÙˆØ³Ø· ğŸŸ¡',
    hard: 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹Ø¨ ğŸ”´'
  };
  
  document.getElementById('quizTitle').textContent = levelNames[level];
  document.getElementById('currentScore').textContent = '0';
  document.getElementById('streakCount').textContent = '0';
  document.getElementById('streakBadge').classList.remove('active');
  
  // Ø¥Ù†Ø´Ø§Ø¡ Ø¯ÙˆØ§Ø¦Ø± Ø§Ù„ØªÙ‚Ø¯Ù…
  const progressSteps = document.getElementById('progressSteps');
  progressSteps.innerHTML = '';
  for (let i = 0; i < 8; i++) {
    const step = document.createElement('div');
    step.className = 'progress-step';
    step.textContent = i + 1;
    step.id = `step-${i}`;
    progressSteps.appendChild(step);
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
  document.getElementById('step-0').classList.add('current');
  
  renderQuestions();
  startTimer();
  showPage('quizPage');
  
  // Ø¥Ø¶Ø§ÙØ© event listener Ù„Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹
  document.getElementById('backButton').onclick = function(e) {
    e.preventDefault();
    e.stopPropagation();
    if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ù‚Ø§Ù‹ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŸ Ø³ØªÙÙ‚Ø¯ ØªÙ‚Ø¯Ù…Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ.')) {
      stopTimer();
      goToLevelSelection();
    }
  };
}

// ==================== Ø®Ù„Ø· Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ====================
function shuffleArray(array) {
  const newArray = [...array];
  for (let i = newArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
  }
  return newArray;
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ====================
function renderQuestions() {
  const container = document.getElementById('questionsContainer');
  container.innerHTML = '';
  
  const questions = questionsBank[currentLevel];
  
  questions.forEach((q, index) => {
    // Ø®Ù„Ø· Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ÙˆØ­ÙØ¸ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    const shuffledOptions = shuffleArray(q.options.map((opt, idx) => ({ text: opt, originalIndex: idx })));
    const correctAnswerText = q.options[q.correct];
    const newCorrectIndex = shuffledOptions.findIndex(opt => opt.text === correctAnswerText);
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
    q.shuffledOptions = shuffledOptions.map(opt => opt.text);
    q.shuffledCorrect = newCorrectIndex;
    const qCard = document.createElement('div');
    qCard.className = 'qcard';
    qCard.id = `question-${index}`;
    
    const leftPanel = document.createElement('div');
    leftPanel.className = 'panel-left';
    
    // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ ÙÙˆÙ‚ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    const funcTitle = document.createElement('div');
    funcTitle.className = 'funcTitle';
    funcTitle.textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}: ${q.func}`;
    
    const chartWrapper = document.createElement('div');
    chartWrapper.className = 'chart-wrapper';
    const canvas = document.createElement('canvas');
    canvas.id = `chart-${index}`;
    chartWrapper.appendChild(canvas);
    
    const hintBtn = document.createElement('button');
    hintBtn.className = 'btn-hint';
    hintBtn.textContent = 'ğŸ’¡ Ø§Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù…ÙŠØ­';
    hintBtn.onclick = () => showHint(index);
    
    // Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªÙ„Ù…ÙŠØ­ (ÙŠØ¸Ù‡Ø±/ÙŠØ®ØªÙÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·)
    const hintBox = document.createElement('div');
    hintBox.className = 'hint-box';
    hintBox.id = `hint-${index}`;
    hintBox.style.display = 'none';
    
    leftPanel.appendChild(funcTitle);
    leftPanel.appendChild(chartWrapper);
    leftPanel.appendChild(hintBtn);
    leftPanel.appendChild(hintBox);
    
    const rightPanel = document.createElement('div');
    rightPanel.className = 'panel-right';
    
    const asks = document.createElement('div');
    asks.className = 'asks';
    asks.textContent = q.asks;
    
    const options = document.createElement('div');
    options.className = 'options';
    options.id = `options-${index}`;
    
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø®Ù„ÙˆØ·Ø©
    q.shuffledOptions.forEach((opt, optIndex) => {
      const optDiv = document.createElement('div');
      optDiv.className = 'opt';
      optDiv.textContent = opt;
      optDiv.onclick = () => selectOption(index, optIndex);
      options.appendChild(optDiv);
    });
    
    const explanationBox = document.createElement('div');
    explanationBox.className = 'explanation-box';
    explanationBox.id = `explanation-${index}`;
    explanationBox.style.display = 'none';
    
    rightPanel.appendChild(asks);
    rightPanel.appendChild(options);
    rightPanel.appendChild(explanationBox);
    
    qCard.appendChild(leftPanel);
    qCard.appendChild(rightPanel);
    container.appendChild(qCard);
    
    // Ø±Ø³Ù… Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    drawQuestionChart(index, q.func);
  });
}

// ==================== Ø±Ø³Ù… Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ====================
function drawQuestionChart(index, funcStr) {
  setTimeout(() => {
    const canvas = document.getElementById(`chart-${index}`);
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    
    const xValues = [];
    const yValues = [];
    
    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø§Ù„Ø© - Ù†Ø³ØªØ®Ø¯Ù… Ù†Ø·Ø§Ù‚ ÙˆØ§Ø­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ§Ù„
    let xMin = -2, xMax = 4, yMax = 100;
    
    // Ù„Ø§ Ù†Ø­ØªØ§Ø¬ Ø´Ø±ÙˆØ· Ù…Ø¹Ù‚Ø¯Ø© - Ù†Ø³ØªØ®Ø¯Ù… Ø­Ø¯ Ø£Ù‚ØµÙ‰ Ø£ÙƒØ¨Ø± Ù„ÙŠØ´Ù…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ§Ù„
    
    for (let x = xMin; x <= xMax; x += 0.05) {
      xValues.push(parseFloat(x.toFixed(2)));
      try {
        const y = evaluateFunction(funcStr, x);
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø­Ø¯ Ø£Ù‚ØµÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
        if (isFinite(y) && Math.abs(y) <= yMax) {
          yValues.push(parseFloat(y.toFixed(2)));
        } else {
          yValues.push(null);
        }
      } catch (e) {
        yValues.push(null);
      }
    }
    
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: xValues,
        datasets: [{
          label: funcStr,
          data: yValues,
          borderColor: '#667eea',
          backgroundColor: 'rgba(102, 126, 234, 0.15)',
          borderWidth: 5,
          pointRadius: 0,
          pointHoverRadius: 10,
          pointHoverBackgroundColor: '#667eea',
          pointHoverBorderColor: '#fff',
          pointHoverBorderWidth: 4,
          tension: 0.4,
          spanGaps: false
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
          mode: 'nearest',
          intersect: false,
          axis: 'x'
        },
        plugins: {
          legend: { 
            display: true,
            position: 'top',
            labels: {
              font: { size: 14, weight: 'bold', family: 'Almarai' },
              color: '#667eea',
              padding: 15
            }
          },
          tooltip: { 
            enabled: true,
            backgroundColor: 'rgba(0, 0, 0, 0.9)',
            titleColor: '#fff',
            bodyColor: '#fff',
            titleFont: { size: 14, weight: 'bold', family: 'Almarai' },
            bodyFont: { size: 13, family: 'Almarai' },
            borderColor: '#667eea',
            borderWidth: 2,
            padding: 12,
            displayColors: false,
            cornerRadius: 8,
            callbacks: {
              title: function(context) {
                const x = context[0].parsed?.x !== undefined ? context[0].parsed.x : parseFloat(context[0].label || 0);
                return 'x = ' + x.toFixed(1);
              },
              label: function(context) {
                const y = context.parsed.y;
                return 'y = ' + y.toFixed(2);
              }
            }
          }
        },
        scales: {
          x: {
            type: 'linear',
            title: { 
              display: true, 
              text: 'x', 
              font: { size: 14, weight: 'bold', family: 'Almarai' },
              color: '#1f2937'
            },
            grid: { 
              color: 'rgba(0,0,0,0.1)',
              lineWidth: 1
            },
            ticks: {
              font: { size: 9, family: 'Almarai' },
              color: '#4b5563',
              maxTicksLimit: 7,
              padding: 8,
              callback: function(value) {
                return value.toFixed(0);
              }
            }
          },
          y: {
            title: { 
              display: true, 
              text: 'y', 
              font: { size: 14, weight: 'bold', family: 'Almarai' },
              color: '#1f2937'
            },
            grid: { 
              color: 'rgba(0,0,0,0.1)',
              lineWidth: 1
            },
            ticks: {
              font: { size: 9, family: 'Almarai' },
              color: '#4b5563',
              maxTicksLimit: 7,
              padding: 8,
              callback: function(value) {
                return value.toFixed(1);
              }
            }
          }
        }
      }
    });
  }, 100);
}

// ==================== ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¯Ø§Ù„Ø© ====================
function evaluateFunction(funcStr, x) {
  // Ø¥Ø²Ø§Ù„Ø© f(x) = Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
  let expr = funcStr.replace(/f\(x\)\s*=\s*/, '').trim();
  
  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø®Ø§ØµØ© Ù‚Ø¨Ù„ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ x
  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Â· Ø¨Ù€ *
  expr = expr.replace(/Â·/g, '*');
  
  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ^ Ø¨Ù€ **
  expr = expr.replace(/\^/g, '**');
  
  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ e Ø¨Ù€ Math.E (ÙˆÙ„ÙƒÙ† Ù„ÙŠØ³ exp ÙÙŠ Ø§Ù„Ø£Ù‚ÙˆØ§Ø³)
  expr = expr.replace(/\be\b/g, 'Math.E');
  
  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ x Ø¨Ø§Ù„Ù‚ÙŠÙ…Ø© (Ù†Ø³ØªØ®Ø¯Ù… Ø­Ø¯ÙˆØ¯ ÙƒÙ„Ù…Ø© Ù„ØªØ¬Ù†Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ x Ø¯Ø§Ø®Ù„ exp)
  expr = expr.replace(/\bx\b/g, `(${x})`);
  
  // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ø§Ù„Ø§Øª Ø®Ø§ØµØ©
  // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ù‚ÙˆØ§Ø³ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø© Ù…Ø«Ù„ ((1/2)) Ø¥Ù„Ù‰ (1/2)
  while (expr.includes('(((')) {
    expr = expr.replace(/\(\(\(/g, '((');
    expr = expr.replace(/\)\)\)/g, '))');
  }
  
  try {
    return eval(expr);
  } catch (e) {
    console.error('Error evaluating:', expr, e);
    return null;
  }
}

// ==================== Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ====================
function selectOption(questionIndex, optionIndex) {
  const question = questionsBank[currentLevel][questionIndex];
  const optionsDiv = document.getElementById(`options-${questionIndex}`);
  const allOptions = optionsDiv.querySelectorAll('.opt');
  
  // Ù…Ù†Ø¹ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¬Ø§Ø¨Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
  if (allOptions[0].classList.contains('answered')) {
    return;
  }
  
  const isCorrect = optionIndex === question.shuffledCorrect;
  
  // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
  const currentStep = document.getElementById(`step-${questionIndex}`);
  currentStep.classList.remove('current');
  
  if (isCorrect) {
    currentScore++;
    currentStreak++;
    
    // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù†Ø¬Ø§Ø­
    playSound('success');
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø®Ø¶Ø±
    currentStep.classList.add('completed');
    
    // Ø¹Ø±Ø¶ Ø´Ø§Ø±Ø© Ø§Ù„ØªØªØ§Ø¨Ø¹
    if (currentStreak >= 3) {
      const streakBadge = document.getElementById('streakBadge');
      streakBadge.classList.add('active');
      document.getElementById('streakCount').textContent = currentStreak;
    }
    
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ´Ø¬ÙŠØ¹ÙŠØ©
    showEncouragement('success');
    
  } else {
    currentStreak = 0;
    
    // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø®Ø·Ø£
    playSound('error');
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø±
    currentStep.classList.add('wrong');
    
    // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø±Ø© Ø§Ù„ØªØªØ§Ø¨Ø¹
    document.getElementById('streakBadge').classList.remove('active');
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªÙŠØ¬Ø©
  document.getElementById('currentScore').textContent = currentScore;
  
  // ØªØ­Ø¯ÙŠØ« Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
  const progressPercentage = Math.round(((questionIndex + 1) / 8) * 100);
  document.getElementById('progressPercentage').textContent = `${progressPercentage}%`;
  
  // ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª (Ø§Ø³ØªØ®Ø¯Ø§Ù… shuffledCorrect Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† correct)
  allOptions.forEach((opt, idx) => {
    opt.classList.add('answered');
    if (idx === question.shuffledCorrect) {
      opt.classList.add('correct');
    } else if (idx === optionIndex) {
      opt.classList.add('wrong');
    }
  });
  
  // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±Ø­
  showExplanation(questionIndex, isCorrect);
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
  if (questionIndex < 7) {
    setTimeout(() => {
      const nextStep = document.getElementById(`step-${questionIndex + 1}`);
      if (nextStep) {
        nextStep.classList.add('current');
      }
    }, 500);
  }
}

// ==================== ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª ====================
function playSound(type) {
  const audioContext = new (window.AudioContext || window.webkitAudioContext)();
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  if (type === 'success') {
    // Ù†ØºÙ…Ø© Ù†Ø¬Ø§Ø­ (Ø£ÙˆØªØ§Ø± Ø³Ø¹ÙŠØ¯Ø©)
    oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
    oscillator.start(audioContext.currentTime);
    oscillator.stop(audioContext.currentTime + 0.5);
  } else if (type === 'error') {
    // Ù†ØºÙ…Ø© Ø®Ø·Ø£ (Ù†ØºÙ…Ø© Ù…Ù†Ø®ÙØ¶Ø©)
    oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
    oscillator.frequency.setValueAtTime(100, audioContext.currentTime + 0.2);
    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
    oscillator.start(audioContext.currentTime);
    oscillator.stop(audioContext.currentTime + 0.4);
  }
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„ØªØ´Ø¬ÙŠØ¹ ====================
function showEncouragement(type) {
  const msg = document.getElementById('encouragementMsg');
  
  if (type === 'success') {
    const messages = [
      'ğŸ‰ Ù…Ù…ØªØ§Ø²! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!',
      'âœ¨ Ø±Ø§Ø¦Ø¹! ÙˆØ§ØµÙ„ Ø§Ù„ØªÙ…ÙŠØ²!',
      'ğŸŒŸ Ø£Ø­Ø³Ù†Øª! Ø£Ù†Øª ØªØªÙ‚Ø¯Ù… Ø¨Ø´ÙƒÙ„ Ø±Ø§Ø¦Ø¹!',
      'ğŸ’ª Ø¹Ù…Ù„ Ø±Ø§Ø¦Ø¹! Ø§Ø³ØªÙ…Ø± Ù‡ÙƒØ°Ø§!',
      'ğŸ† Ø¥Ø¬Ø§Ø¨Ø© Ù…Ø«Ø§Ù„ÙŠØ©!'
    ];
    msg.textContent = messages[Math.floor(Math.random() * messages.length)];
    msg.className = 'encouragement-msg success show';
  }
  
  setTimeout(() => {
    msg.classList.remove('show');
  }, 3000);
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±Ø­ ====================
function showExplanation(index, isCorrect) {
  const question = questionsBank[currentLevel][index];
  const expBox = document.getElementById(`explanation-${index}`);
  
  expBox.className = `explanation-box ${isCorrect ? 'good' : 'bad'}`;
  expBox.style.display = 'block';
  
  let html = '';
  
  if (isCorrect) {
    // Ø¥Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©: ÙÙ‚Ø· Ø£Ø­Ø³Ù†Øª Ù…Ø¹ Ø¥ÙŠÙ…ÙˆØ¬ÙŠ
    html = `
      <div style="font-size: 28px; font-weight: 800; padding: 25px; text-align: center; color: #10b981;">
        Ø£Ø­Ø³Ù†Øª! ğŸ‰
      </div>
    `;
  } else {
    // Ø¥Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©: Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© + Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† Ø®Ø§Ù†Ø© Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©)
    html = `
      <div style="background: #dcfce7; border-right: 4px solid #10b981; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align: right;">
        <strong style="color: #065f46; font-size: 16px;">ğŸ“š Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©:</strong>
        <div style="color: #064e3b; font-size: 15px; margin-top: 10px; line-height: 2; white-space: pre-line; font-weight: 500;">${question.steps}</div>
      </div>
      
      <div style="background: #dbeafe; border-right: 4px solid #3b82f6; padding: 15px; border-radius: 8px; text-align: right;">
        <strong style="color: #1e40af; font-size: 16px;">ğŸ’¡ Ø§Ù„Ø´Ø±Ø­ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ:</strong>
        <div style="color: #1e3a8a; font-size: 15px; margin-top: 10px; line-height: 2; font-weight: 500;">${question.explanation}</div>
      </div>
    `;
  }
  
  expBox.innerHTML = html;
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù…ÙŠØ­ ====================
function showHint(index) {
  const question = questionsBank[currentLevel][index];
  const hintBox = document.getElementById(`hint-${index}`);
  
  // Toggle: Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡
  if (hintBox.style.display === 'none') {
    hintBox.innerHTML = `
      <div style="background: #e0e7ff; border-right: 4px solid #667eea; padding: 15px; border-radius: 8px; text-align: right; margin-top: 15px;">
        <strong style="color: #3730a3; font-size: 16px;">ğŸ’¡ ØªÙ„Ù…ÙŠØ­:</strong>
        <div style="color: #3730a3; font-size: 15px; margin-top: 10px; line-height: 2; white-space: pre-line;">${question.steps}</div>
      </div>
    `;
    hintBox.style.display = 'block';
  } else {
    hintBox.style.display = 'none';
  }
}

// ==================== Ø§Ù„Ù…Ø¤Ù‚Øª ====================
function startTimer() {
  const timerDisplay = document.getElementById('timerDisplay');
  const timerBadge = document.getElementById('timerBadge');
  
  timerInterval = setInterval(() => {
    totalTime--;
    
    const minutes = Math.floor(totalTime / 60);
    const seconds = totalTime % 60;
    timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    
    if (totalTime <= 60) {
      timerBadge.classList.add('warning');
    }
    
    if (totalTime <= 0) {
      stopTimer();
      showFinalScore();
    }
  }, 1000);
}

function stopTimer() {
  if (timerInterval) {
    clearInterval(timerInterval);
    timerInterval = null;
  }
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ====================
function showFinalScore() {
  stopTimer();
  
  const percentage = (currentScore / 8) * 100;
  const finalScoreDiv = document.getElementById('finalScore');
  const finalGradeText = document.getElementById('finalGradeText');
  const finalMessage = document.getElementById('finalMessage');
  const badgeContainer = document.getElementById('badgeContainer');
  
  finalGradeText.textContent = `${currentScore} / 8`;
  
  if (percentage >= 87.5) {
    finalGradeText.className = 'final-grade grade-good';
    finalMessage.textContent = 'ğŸ‰ Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹! Ø£Ø¯Ø§Ø¡ Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠ! Ø£Ù†Øª ØªÙ…ØªÙ„Ùƒ ÙÙ‡Ù…Ø§Ù‹ Ø¹Ù…ÙŠÙ‚Ø§Ù‹ Ù„Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø£Ø³ÙŠØ©!';
    badgeContainer.innerHTML = '<div class="achievement-badge badge-gold">ğŸ† ÙˆØ³Ø§Ù… Ø§Ù„ØªÙ…ÙŠØ² Ø§Ù„Ø°Ù‡Ø¨ÙŠ</div>';
  } else if (percentage >= 75) {
    finalGradeText.className = 'final-grade grade-good';
    finalMessage.textContent = 'ğŸŒŸ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹! Ø£Ø¯Ø§Ø¡ Ø±Ø§Ø¦Ø¹! Ø£Ù†Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„ØµØ­ÙŠØ­!';
    badgeContainer.innerHTML = '<div class="achievement-badge badge-silver">ğŸ¥ˆ ÙˆØ³Ø§Ù… Ø§Ù„ØªÙ…ÙŠØ² Ø§Ù„ÙØ¶ÙŠ</div>';
  } else if (percentage >= 62.5) {
    finalGradeText.className = 'final-grade';
    finalMessage.textContent = 'ğŸ‘ Ø¬ÙŠØ¯! Ø£Ø¯Ø§Ø¡ Ù…Ù‚Ø¨ÙˆÙ„ØŒ Ù„ÙƒÙ† ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¦Ùƒ Ø¨Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨!';
    badgeContainer.innerHTML = '<div class="achievement-badge badge-bronze">ğŸ¥‰ ÙˆØ³Ø§Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</div>';
  } else {
    finalGradeText.className = 'final-grade grade-bad';
    finalMessage.textContent = 'ğŸ“š ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©!';
    badgeContainer.innerHTML = '';
  }
  
  finalScoreDiv.style.display = 'block';
}

function resetAndBackToLevels() {
  document.getElementById('finalScore').style.display = 'none';
  goToLevelSelection();
}

// ==================== Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ù„Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ====================
function setupCalculatorForFunction(funcType) {
  const calcTitle = document.getElementById('calcTitle');
  const inputsContainer = document.getElementById('inputsContainer');
  
  // Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬
  document.getElementById('resultsSection').style.display = 'none';
  
  const functionConfigs = {
    exponential: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ©',
      formula: 'f(x) = a Â· b<sup>(xÂ±h)</sup> Â± k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a (Ø§Ù„ØªÙ…Ø¯Ø¯/Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³):</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø£Ø³Ø§Ø³ b (Base):</label>
          <input type="number" id="inputBase" value="2" step="0.1" min="0.01">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø¥ØªØ¬Ø§Ù‡ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ©:</label>
          <select id="inputHSign">
            <option value="1">+ (ÙŠØ³Ø§Ø±)</option>
            <option value="-1">- (ÙŠÙ…ÙŠÙ†)</option>
          </select>
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø¥ØªØ¬Ø§Ù‡ Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ©:</label>
          <select id="inputKSign">
            <option value="1">+ (Ø£Ø¹Ù„Ù‰)</option>
            <option value="-1">- (Ø£Ø³ÙÙ„)</option>
          </select>
        </div>
      `
    },
    linear: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø®Ø·ÙŠØ©',
      formula: 'f(x) = mx + b',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…ÙŠÙ„ m:</label>
          <input type="number" id="inputM" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…Ø­ÙˆØ± y (b):</label>
          <input type="number" id="inputB" value="0" step="0.5">
        </div>
      `
    },
    quadratic: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠØ©',
      formula: 'f(x) = a(x-h)Â² + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    cubic: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠØ©',
      formula: 'f(x) = a(x-h)Â³ + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    sqrt: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ',
      formula: 'f(x) = aâˆš(x-h) + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    cbrt: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠ',
      formula: 'f(x) = aâˆ›(x-h) + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    absolute: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø¯Ø§Ù„Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©',
      formula: 'f(x) = a|x-h| + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    logarithm: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù„ÙˆØºØ§Ø±ÙŠØªÙ…ÙŠØ©',
      formula: 'f(x) = a Â· log<sub>b</sub>(x-h) + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø£Ø³Ø§Ø³ b:</label>
          <input type="number" id="inputBase" value="10" step="0.1" min="0.01">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    sine: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬ÙŠØ¨',
      formula: 'f(x) = a Â· sin(b(x-h)) + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ø³Ø¹Ø© a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„ØªØ±Ø¯Ø¯ b:</label>
          <input type="number" id="inputB" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    cosine: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø¯Ø§Ù„Ø© Ø¬ÙŠØ¨ Ø§Ù„ØªÙ…Ø§Ù…',
      formula: 'f(x) = a Â· cos(b(x-h)) + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ø³Ø¹Ø© a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„ØªØ±Ø¯Ø¯ b:</label>
          <input type="number" id="inputB" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    tangent: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø¯Ø§Ù„Ø© Ø§Ù„Ø¸Ù„',
      formula: 'f(x) = a Â· tan(b(x-h)) + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„ØªØ±Ø¯Ø¯ b:</label>
          <input type="number" id="inputB" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    },
    rational: {
      title: 'ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ÙƒØ³Ø±ÙŠØ©',
      formula: 'f(x) = a/(x-h) + k',
      inputs: `
        <div class="input-field">
          <label>Ø§Ù„Ù…Ø¹Ø§Ù…Ù„ a:</label>
          <input type="number" id="inputA" value="1" step="0.1">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø£ÙÙ‚ÙŠØ© h:</label>
          <input type="number" id="inputH" value="0" step="0.5">
        </div>
        <div class="input-field">
          <label>Ø§Ù„Ø¥Ø²Ø§Ø­Ø© Ø§Ù„Ø±Ø£Ø³ÙŠØ© k:</label>
          <input type="number" id="inputK" value="0" step="0.5">
        </div>
      `
    }
  };
  
  const config = functionConfigs[funcType];
  if (config) {
    calcTitle.textContent = config.title;
    inputsContainer.innerHTML = config.inputs;
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØµÙŠØºØ©
    const formulaDisplay = document.getElementById('formulaDisplay');
    if (formulaDisplay) {
      formulaDisplay.innerHTML = config.formula;
    }
  }
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ù„Ø© ====================
function calculateFunction() {
  const funcType = selectedFunction;
  
  let result = {};
  
  switch(funcType) {
    case 'exponential':
      result = calculateExponential();
      break;
    case 'linear':
      result = calculateLinear();
      break;
    case 'quadratic':
      result = calculateQuadratic();
      break;
    case 'cubic':
      result = calculateCubic();
      break;
    case 'sqrt':
      result = calculateSqrt();
      break;
    case 'cbrt':
      result = calculateCbrt();
      break;
    case 'absolute':
      result = calculateAbsolute();
      break;
    case 'logarithm':
      result = calculateLogarithm();
      break;
    case 'sine':
      result = calculateSine();
      break;
    case 'cosine':
      result = calculateCosine();
      break;
    case 'tangent':
      result = calculateTangent();
      break;
    case 'rational':
      result = calculateRational();
      break;
  }
  
  displayResults(result);
  drawCalculatorChart(result);
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø£Ø³ÙŠØ© ====================
function calculateExponential() {
  const a = parseFloat(document.getElementById('inputA').value);
  const base = parseFloat(document.getElementById('inputBase').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const hSign = parseFloat(document.getElementById('inputHSign').value);
  const k = parseFloat(document.getElementById('inputK').value);
  const kSign = parseFloat(document.getElementById('inputKSign').value);
  
  const actualH = h * hSign;
  const actualK = k * kSign;
  
  // Ø¨Ù†Ø§Ø¡ Ø§Ù„ØµÙŠØºØ©
  let hPart = '';
  if (h !== 0) {
    if (hSign === 1) {
      hPart = `(x+${Math.abs(h)})`;
    } else {
      hPart = `(x-${Math.abs(h)})`;
    }
  } else {
    hPart = 'x';
  }
  
  let kPart = '';
  if (actualK !== 0) {
    kPart = actualK > 0 ? ` + ${Math.abs(actualK)}` : ` - ${Math.abs(actualK)}`;
  }
  
  const functionStr = `f(x) = ${a}Â·${base}<sup>${hPart}</sup>${kPart}`;
  
  // Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø§Ù„Ø©
  let funcType = '';
  if (base > 1) {
    funcType = a > 0 ? 'Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø© â†—ï¸' : 'Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ© Ù…Ø¹ Ø§Ù†Ø¹ÙƒØ§Ø³ â†˜ï¸';
  } else if (base > 0 && base < 1) {
    funcType = a > 0 ? 'Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ© â†˜ï¸' : 'Ø¯Ø§Ù„Ø© Ø£Ø³ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù†Ø¹ÙƒØ§Ø³ â†—ï¸';
  }
  
  // Ø§Ù„Ù…Ø¬Ø§Ù„ ÙˆØ§Ù„Ù…Ø¯Ù‰
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  let range = '';
  if (a > 0) {
    range = `y > ${actualK}`;
  } else {
    range = `y < ${actualK}`;
  }
  
  // Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨
  const asymptote = `y = ${actualK}`;
  
  // Ø§Ù„Ø¥Ø²Ø§Ø­Ø§Øª
  const hShift = actualH === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : 
                 actualH > 0 ? `${Math.abs(actualH)} ÙˆØ­Ø¯Ø§Øª Ù„Ù„ÙŠØ³Ø§Ø± â†` : 
                 `${Math.abs(actualH)} ÙˆØ­Ø¯Ø§Øª Ù„Ù„ÙŠÙ…ÙŠÙ† â†’`;
  
  const vShift = actualK === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : 
                 actualK > 0 ? `${Math.abs(actualK)} ÙˆØ­Ø¯Ø§Øª Ù„Ø£Ø¹Ù„Ù‰ â†‘` : 
                 `${Math.abs(actualK)} ÙˆØ­Ø¯Ø§Øª Ù„Ø£Ø³ÙÙ„ â†“`;
  
  // Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…Ø­ÙˆØ± y
  const yIntercept = a * Math.pow(base, actualH) + actualK;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  // Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª
  let transformations = [];
  if (Math.abs(a) !== 1) {
    transformations.push(`ØªÙ…Ø¯Ø¯ Ø±Ø£Ø³ÙŠ Ø¨Ù…Ø¹Ø§Ù…Ù„ ${Math.abs(a)}`);
  }
  if (a < 0) {
    transformations.push('Ø§Ù†Ø¹ÙƒØ§Ø³ Ø­ÙˆÙ„ Ø§Ù„Ù…Ø­ÙˆØ± x');
  }
  if (actualH !== 0) {
    transformations.push(hShift);
  }
  if (actualK !== 0) {
    transformations.push(vShift);
  }
  const transformationsStr = transformations.length > 0 ? transformations.join('ØŒ ') : 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­ÙˆÙŠÙ„Ø§Øª';
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, base, actualH, actualK,
    type: 'exponential'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø®Ø·ÙŠØ© ====================
function calculateLinear() {
  const m = parseFloat(document.getElementById('inputM').value);
  const b = parseFloat(document.getElementById('inputB').value);
  
  const functionStr = `f(x) = ${m}x ${b >= 0 ? '+' : ''} ${b}`;
  
  const funcType = m > 0 ? 'Ø¯Ø§Ù„Ø© Ø®Ø·ÙŠØ© Ù…ØªØ²Ø§ÙŠØ¯Ø© â†—ï¸' : m < 0 ? 'Ø¯Ø§Ù„Ø© Ø®Ø·ÙŠØ© Ù…ØªÙ†Ø§Ù‚ØµØ© â†˜ï¸' : 'Ø¯Ø§Ù„Ø© Ø«Ø§Ø¨ØªØ© â†’';
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const range = m !== 0 ? 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)' : `y = ${b}`;
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©';
  const vShift = b === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(b)} ÙˆØ­Ø¯Ø§Øª ${b > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  const yInterceptStr = `(0, ${b})`;
  const transformationsStr = `Ø§Ù„Ù…ÙŠÙ„ = ${m}ØŒ Ù…Ù‚Ø·Ø¹ Ø§Ù„Ù…Ø­ÙˆØ± y = ${b}`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    m, b,
    type: 'linear'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠØ© ====================
function calculateQuadratic() {
  const a = parseFloat(document.getElementById('inputA').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}${hPart}Â²${kPart}`;
  
  const funcType = a > 0 ? 'Ù‚Ø·Ø¹ Ù…ÙƒØ§ÙØ¦ Ù…ÙØªÙˆØ­ Ù„Ø£Ø¹Ù„Ù‰ âˆª' : 'Ù‚Ø·Ø¹ Ù…ÙƒØ§ÙØ¦ Ù…ÙØªÙˆØ­ Ù„Ø£Ø³ÙÙ„ âˆ©';
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const range = a > 0 ? `y â‰¥ ${k}` : `y â‰¤ ${k}`;
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a * Math.pow(-h, 2) + k;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  const transformationsStr = `Ø§Ù„Ø±Ø£Ø³: (${h}, ${k})`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, h, k,
    type: 'quadratic'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠØ© ====================
function calculateCubic() {
  const a = parseFloat(document.getElementById('inputA').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}${hPart}Â³${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© ØªÙƒØ¹ÙŠØ¨ÙŠØ©';
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const range = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a * Math.pow(-h, 3) + k;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  const transformationsStr = `Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø¹Ø·Ø§Ù: (${h}, ${k})`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, h, k,
    type: 'cubic'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªØ±Ø¨ÙŠØ¹ÙŠ ====================
function calculateSqrt() {
  const a = parseFloat(document.getElementById('inputA').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}âˆš${hPart}${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© Ø¬Ø°Ø± ØªØ±Ø¨ÙŠØ¹ÙŠ';
  const domain = `x â‰¥ ${h}`;
  const range = a > 0 ? `y â‰¥ ${k}` : `y â‰¤ ${k}`;
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = h <= 0 ? `(0, ${(a * Math.sqrt(-h) + k).toFixed(2)})` : 'ØºÙŠØ± Ù…Ø¹Ø±Ù‘Ù (x < 0)';
  const yInterceptStr = yIntercept;
  
  const transformationsStr = `Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©: (${h}, ${k})`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, h, k,
    type: 'sqrt'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø°Ø± Ø§Ù„ØªÙƒØ¹ÙŠØ¨ÙŠ ====================
function calculateCbrt() {
  const a = parseFloat(document.getElementById('inputA').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}âˆ›${hPart}${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© Ø¬Ø°Ø± ØªÙƒØ¹ÙŠØ¨ÙŠ';
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const range = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a * Math.cbrt(-h) + k;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  const transformationsStr = `Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø¹Ø·Ø§Ù: (${h}, ${k})`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, h, k,
    type: 'cbrt'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø¯Ø§Ù„Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø·Ù„Ù‚Ø© ====================
function calculateAbsolute() {
  const a = parseFloat(document.getElementById('inputA').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `x-${h}` : `x+${Math.abs(h)}`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}|${hPart}|${kPart}`;
  
  const funcType = a > 0 ? 'Ø¯Ø§Ù„Ø© Ù‚ÙŠÙ…Ø© Ù…Ø·Ù„Ù‚Ø© Ù…ÙØªÙˆØ­Ø© Ù„Ø£Ø¹Ù„Ù‰ âˆ¨' : 'Ø¯Ø§Ù„Ø© Ù‚ÙŠÙ…Ø© Ù…Ø·Ù„Ù‚Ø© Ù…ÙØªÙˆØ­Ø© Ù„Ø£Ø³ÙÙ„ âˆ§';
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const range = a > 0 ? `y â‰¥ ${k}` : `y â‰¤ ${k}`;
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a * Math.abs(-h) + k;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  const transformationsStr = `Ø§Ù„Ø±Ø£Ø³: (${h}, ${k})`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, h, k,
    type: 'absolute'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù„ÙˆØºØ§Ø±ÙŠØªÙ…ÙŠØ© ====================
function calculateLogarithm() {
  const a = parseFloat(document.getElementById('inputA').value);
  const base = parseFloat(document.getElementById('inputBase').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}Â·log<sub>${base}</sub>${hPart}${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© Ù„ÙˆØºØ§Ø±ÙŠØªÙ…ÙŠØ©';
  const domain = `x > ${h}`;
  const range = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const asymptote = `x = ${h} (Ø®Ø· ØªÙ‚Ø§Ø±Ø¨ Ø±Ø£Ø³ÙŠ)`;
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yInterceptStr = h < 0 ? `(0, ${(a * Math.log(-h) / Math.log(base) + k).toFixed(2)})` : 'ØºÙŠØ± Ù…Ø¹Ø±Ù‘Ù';
  
  const transformationsStr = `Ø§Ù„Ø£Ø³Ø§Ø³: ${base}ØŒ Ù†Ù‚Ø·Ø© Ù…Ø±Ø¬Ø¹ÙŠØ©: (${h + 1}, ${k})`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, base, h, k,
    type: 'logarithm'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬ÙŠØ¨ ====================
function calculateSine() {
  const a = parseFloat(document.getElementById('inputA').value);
  const b = parseFloat(document.getElementById('inputB').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}Â·sin(${b}${hPart})${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© Ø¬ÙŠØ¨';
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const range = `[${k - Math.abs(a)}, ${k + Math.abs(a)}]`;
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a * Math.sin(b * (-h)) + k;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  const period = (2 * Math.PI) / Math.abs(b);
  const transformationsStr = `Ø§Ù„Ø³Ø¹Ø©: ${Math.abs(a)}ØŒ Ø§Ù„Ø¯ÙˆØ±Ø©: ${period.toFixed(2)}`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, b, h, k,
    type: 'sine'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø¯Ø§Ù„Ø© Ø¬ÙŠØ¨ Ø§Ù„ØªÙ…Ø§Ù… ====================
function calculateCosine() {
  const a = parseFloat(document.getElementById('inputA').value);
  const b = parseFloat(document.getElementById('inputB').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}Â·cos(${b}${hPart})${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© Ø¬ÙŠØ¨ Ø§Ù„ØªÙ…Ø§Ù…';
  const domain = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const range = `[${k - Math.abs(a)}, ${k + Math.abs(a)}]`;
  const asymptote = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a * Math.cos(b * (-h)) + k;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  const period = (2 * Math.PI) / Math.abs(b);
  const transformationsStr = `Ø§Ù„Ø³Ø¹Ø©: ${Math.abs(a)}ØŒ Ø§Ù„Ø¯ÙˆØ±Ø©: ${period.toFixed(2)}`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, b, h, k,
    type: 'cosine'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø¯Ø§Ù„Ø© Ø§Ù„Ø¸Ù„ ====================
function calculateTangent() {
  const a = parseFloat(document.getElementById('inputA').value);
  const b = parseFloat(document.getElementById('inputB').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}Â·tan(${b}${hPart})${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© Ø§Ù„Ø¸Ù„';
  const domain = `x â‰  ${h} + (Ï€/(2${b})) + nÏ€/${b}`;
  const range = 'â„ (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)';
  const asymptote = `Ø®Ø·ÙˆØ· ØªÙ‚Ø§Ø±Ø¨ Ø±Ø£Ø³ÙŠØ© Ø¹Ù†Ø¯ x = ${h} + (Ï€/(2${b})) + nÏ€/${b}`;
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a * Math.tan(b * (-h)) + k;
  const yInterceptStr = `(0, ${yIntercept.toFixed(2)})`;
  
  const period = Math.PI / Math.abs(b);
  const transformationsStr = `Ø§Ù„Ø¯ÙˆØ±Ø©: ${period.toFixed(2)}`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, b, h, k,
    type: 'tangent'
  };
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ÙƒØ³Ø±ÙŠØ© ====================
function calculateRational() {
  const a = parseFloat(document.getElementById('inputA').value);
  const h = parseFloat(document.getElementById('inputH').value);
  const k = parseFloat(document.getElementById('inputK').value);
  
  let hPart = h === 0 ? 'x' : h > 0 ? `(x-${h})` : `(x+${Math.abs(h)})`;
  let kPart = k === 0 ? '' : k > 0 ? ` + ${k}` : ` - ${Math.abs(k)}`;
  
  const functionStr = `f(x) = ${a}/${hPart}${kPart}`;
  
  const funcType = 'Ø¯Ø§Ù„Ø© ÙƒØ³Ø±ÙŠØ© (Ø¯Ø§Ù„Ø© Ù†Ø³Ø¨ÙŠØ©)';
  const domain = `x â‰  ${h}`;
  const range = `y â‰  ${k}`;
  const asymptote = `Ø®Ø· ØªÙ‚Ø§Ø±Ø¨ Ø±Ø£Ø³ÙŠ: x = ${h}ØŒ Ø®Ø· ØªÙ‚Ø§Ø±Ø¨ Ø£ÙÙ‚ÙŠ: y = ${k}`;
  const hShift = h === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(h)} ÙˆØ­Ø¯Ø§Øª ${h > 0 ? 'Ù„Ù„ÙŠÙ…ÙŠÙ† â†’' : 'Ù„Ù„ÙŠØ³Ø§Ø± â†'}`;
  const vShift = k === 0 ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø²Ø§Ø­Ø©' : `${Math.abs(k)} ÙˆØ­Ø¯Ø§Øª ${k > 0 ? 'Ù„Ø£Ø¹Ù„Ù‰ â†‘' : 'Ù„Ø£Ø³ÙÙ„ â†“'}`;
  
  const yIntercept = a / (-h) + k;
  const yInterceptStr = h !== 0 ? `(0, ${yIntercept.toFixed(2)})` : 'ØºÙŠØ± Ù…Ø¹Ø±Ù‘Ù';
  
  const transformationsStr = `Ù…Ø±ÙƒØ² Ø§Ù„ØªÙ…Ø§Ø«Ù„: (${h}, ${k})`;
  
  return {
    functionStr,
    funcType,
    domain,
    range,
    asymptote,
    hShift,
    vShift,
    yInterceptStr,
    transformationsStr,
    a, h, k,
    type: 'rational'
  };
}

// ==================== Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ====================
function displayResults(result) {
  document.getElementById('resultsSection').style.display = 'block';
  document.getElementById('functionDisplay').innerHTML = result.functionStr;
  document.getElementById('resultType').textContent = result.funcType;
  document.getElementById('resultDomain').textContent = result.domain;
  document.getElementById('resultRange').textContent = result.range;
  document.getElementById('resultAsymptote').textContent = result.asymptote;
  document.getElementById('resultHShift').textContent = result.hShift;
  document.getElementById('resultVShift').textContent = result.vShift;
  document.getElementById('resultYIntercept').textContent = result.yInterceptStr;
  document.getElementById('resultTransformations').textContent = result.transformationsStr;
  
  // Scroll to results
  document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
}

// ==================== Ø±Ø³Ù… Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ====================
function drawCalculatorChart(result) {
  const canvas = document.getElementById('calcChart');
  const ctx = canvas.getContext('2d');
  
  if (calcChart) {
    calcChart.destroy();
  }
  
  const xValues = [];
  const yValues = [];
  
  let xMin = -2, xMax = 4;
  
  // Ù„Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ù†Ø·Ø§Ù‚ Ù…Ø­Ø¯Ø¯
  if (result.type === 'sqrt') {
    xMin = Math.max(-2, result.h - 1);
  } else if (result.type === 'logarithm') {
    xMin = Math.max(0.01, result.h + 0.01);
  }
  
  for (let x = xMin; x <= xMax; x += 0.1) {
    xValues.push(x);
    let y = null;
    
    try {
      switch(result.type) {
        case 'exponential':
          y = result.a * Math.pow(result.base, x + result.actualH) + result.actualK;
          break;
        case 'linear':
          y = result.m * x + result.b;
          break;
        case 'quadratic':
          y = result.a * Math.pow(x - result.h, 2) + result.k;
          break;
        case 'cubic':
          y = result.a * Math.pow(x - result.h, 3) + result.k;
          break;
        case 'sqrt':
          if (x >= result.h) {
            y = result.a * Math.sqrt(x - result.h) + result.k;
          }
          break;
        case 'cbrt':
          y = result.a * Math.cbrt(x - result.h) + result.k;
          break;
        case 'absolute':
          y = result.a * Math.abs(x - result.h) + result.k;
          break;
        case 'logarithm':
          if (x > result.h) {
            y = result.a * Math.log(x - result.h) / Math.log(result.base) + result.k;
          }
          break;
        case 'sine':
          y = result.a * Math.sin(result.b * (x - result.h)) + result.k;
          break;
        case 'cosine':
          y = result.a * Math.cos(result.b * (x - result.h)) + result.k;
          break;
        case 'tangent':
          y = result.a * Math.tan(result.b * (x - result.h)) + result.k;
          // ØªØ¬Ù†Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹
          if (Math.abs(y) > 20) y = null;
          break;
        case 'rational':
          if (x !== result.h) {
            y = result.a / (x - result.h) + result.k;
            // ØªØ¬Ù†Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹
            if (Math.abs(y) > 20) y = null;
          }
          break;
      }
      
      if (y !== null && isFinite(y) && Math.abs(y) < 100) {
        yValues.push(y);
      } else {
        yValues.push(null);
      }
    } catch (e) {
      yValues.push(null);
    }
  }
  
  calcChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: xValues,
      datasets: [{
        label: 'f(x)',
        data: yValues,
        borderColor: '#667eea',
        backgroundColor: 'rgba(102, 126, 234, 0.15)',
        borderWidth: 5,
        pointRadius: 0,
        pointHoverRadius: 10,
        pointHoverBackgroundColor: '#667eea',
        pointHoverBorderColor: '#fff',
        pointHoverBorderWidth: 4,
        tension: 0.4,
        spanGaps: false
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: { 
          enabled: true,
          callbacks: {
            title: function(context) {
              return `x = ${context[0].label}`;
            },
            label: function(context) {
              return `f(x) = ${context.parsed.y.toFixed(2)}`;
            }
          }
        }
      },
      scales: {
        x: {
          type: 'linear',
          title: { display: true, text: 'x', font: { size: 16, weight: 'bold' } },
          grid: { color: 'rgba(0,0,0,0.1)' }
        },
        y: {
          title: { display: true, text: 'f(x)', font: { size: 16, weight: 'bold' } },
          grid: { color: 'rgba(0,0,0,0.1)' }
        }
      }
    }
  });
}

// ==================== Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¹ÙˆÙŠØ¶ ====================
function calculateSubstitution() {
  const xValue = parseFloat(document.getElementById('inputXValue').value);
  
  if (isNaN(xValue)) {
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø© Ù„Ù€ x');
    return;
  }
  
  const funcType = selectedFunction;
  let result, steps, finalValue;
  
  switch(funcType) {
    case 'exponential':
      const a = parseFloat(document.getElementById('inputA').value);
      const base = parseFloat(document.getElementById('inputBase').value);
      const h = parseFloat(document.getElementById('inputH').value);
      const hSign = parseFloat(document.getElementById('inputHSign').value);
      const k = parseFloat(document.getElementById('inputK').value);
      const kSign = parseFloat(document.getElementById('inputKSign').value);
      
      const actualH = h * hSign;
      const actualK = k * kSign;
      
      const exponent = xValue + actualH;
      const powerResult = Math.pow(base, exponent);
      finalValue = a * powerResult + actualK;
      
      let hPartDisplay = h === 0 ? '' : hSign === 1 ? `+${h}` : `-${h}`;
      let kPartDisplay = actualK === 0 ? '' : actualK >= 0 ? `+${actualK}` : `${actualK}`;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${a}Â·${base}<sup>(x${hPartDisplay})</sup>${kPartDisplay}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${a}Â·${base}<sup>(${xValue}${hPartDisplay})</sup>${kPartDisplay}<br>
        f(${xValue}) = ${a}Â·${base}<sup>${exponent}</sup>${kPartDisplay}<br>
        f(${xValue}) = ${a}Â·${powerResult.toFixed(4)}${kPartDisplay}<br>
        f(${xValue}) = ${(a * powerResult).toFixed(4)}${kPartDisplay}
      `;
      break;
      
    case 'linear':
      const m = parseFloat(document.getElementById('inputM').value);
      const b = parseFloat(document.getElementById('inputB').value);
      
      finalValue = m * xValue + b;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${m}x ${b >= 0 ? '+' : ''}${b}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${m}(${xValue}) ${b >= 0 ? '+' : ''}${b}<br>
        f(${xValue}) = ${(m * xValue).toFixed(4)} ${b >= 0 ? '+' : ''}${b}
      `;
      break;
      
    case 'quadratic':
      const aQuad = parseFloat(document.getElementById('inputA').value);
      const hQuad = parseFloat(document.getElementById('inputH').value);
      const kQuad = parseFloat(document.getElementById('inputK').value);
      
      const xMinusH = xValue - hQuad;
      const squared = Math.pow(xMinusH, 2);
      finalValue = aQuad * squared + kQuad;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aQuad}(x-${hQuad})Â² ${kQuad >= 0 ? '+' : ''}${kQuad}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aQuad}(${xValue}-${hQuad})Â² ${kQuad >= 0 ? '+' : ''}${kQuad}<br>
        f(${xValue}) = ${aQuad}(${xMinusH})Â² ${kQuad >= 0 ? '+' : ''}${kQuad}<br>
        f(${xValue}) = ${aQuad}Â·${squared.toFixed(4)} ${kQuad >= 0 ? '+' : ''}${kQuad}<br>
        f(${xValue}) = ${(aQuad * squared).toFixed(4)} ${kQuad >= 0 ? '+' : ''}${kQuad}
      `;
      break;
      
    case 'cubic':
      const aCubic = parseFloat(document.getElementById('inputA').value);
      const hCubic = parseFloat(document.getElementById('inputH').value);
      const kCubic = parseFloat(document.getElementById('inputK').value);
      
      const xMinusHCubic = xValue - hCubic;
      const cubed = Math.pow(xMinusHCubic, 3);
      finalValue = aCubic * cubed + kCubic;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aCubic}(x-${hCubic})Â³ ${kCubic >= 0 ? '+' : ''}${kCubic}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aCubic}(${xValue}-${hCubic})Â³ ${kCubic >= 0 ? '+' : ''}${kCubic}<br>
        f(${xValue}) = ${aCubic}(${xMinusHCubic})Â³ ${kCubic >= 0 ? '+' : ''}${kCubic}<br>
        f(${xValue}) = ${aCubic}Â·${cubed.toFixed(4)} ${kCubic >= 0 ? '+' : ''}${kCubic}<br>
        f(${xValue}) = ${(aCubic * cubed).toFixed(4)} ${kCubic >= 0 ? '+' : ''}${kCubic}
      `;
      break;
      
    case 'sqrt':
      const aSqrt = parseFloat(document.getElementById('inputA').value);
      const hSqrt = parseFloat(document.getElementById('inputH').value);
      const kSqrt = parseFloat(document.getElementById('inputK').value);
      
      if (xValue < hSqrt) {
        alert(`Ù‚ÙŠÙ…Ø© x ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† Ø£Ùˆ ØªØ³Ø§ÙˆÙŠ ${hSqrt}`);
        return;
      }
      
      const xMinusHSqrt = xValue - hSqrt;
      const sqrtResult = Math.sqrt(xMinusHSqrt);
      finalValue = aSqrt * sqrtResult + kSqrt;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aSqrt}âˆš(x-${hSqrt}) ${kSqrt >= 0 ? '+' : ''}${kSqrt}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aSqrt}âˆš(${xValue}-${hSqrt}) ${kSqrt >= 0 ? '+' : ''}${kSqrt}<br>
        f(${xValue}) = ${aSqrt}âˆš${xMinusHSqrt} ${kSqrt >= 0 ? '+' : ''}${kSqrt}<br>
        f(${xValue}) = ${aSqrt}Â·${sqrtResult.toFixed(4)} ${kSqrt >= 0 ? '+' : ''}${kSqrt}<br>
        f(${xValue}) = ${(aSqrt * sqrtResult).toFixed(4)} ${kSqrt >= 0 ? '+' : ''}${kSqrt}
      `;
      break;
      
    case 'cbrt':
      const aCbrt = parseFloat(document.getElementById('inputA').value);
      const hCbrt = parseFloat(document.getElementById('inputH').value);
      const kCbrt = parseFloat(document.getElementById('inputK').value);
      
      const xMinusHCbrt = xValue - hCbrt;
      const cbrtResult = Math.cbrt(xMinusHCbrt);
      finalValue = aCbrt * cbrtResult + kCbrt;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aCbrt}âˆ›(x-${hCbrt}) ${kCbrt >= 0 ? '+' : ''}${kCbrt}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aCbrt}âˆ›(${xValue}-${hCbrt}) ${kCbrt >= 0 ? '+' : ''}${kCbrt}<br>
        f(${xValue}) = ${aCbrt}âˆ›${xMinusHCbrt} ${kCbrt >= 0 ? '+' : ''}${kCbrt}<br>
        f(${xValue}) = ${aCbrt}Â·${cbrtResult.toFixed(4)} ${kCbrt >= 0 ? '+' : ''}${kCbrt}<br>
        f(${xValue}) = ${(aCbrt * cbrtResult).toFixed(4)} ${kCbrt >= 0 ? '+' : ''}${kCbrt}
      `;
      break;
      
    case 'absolute':
      const aAbs = parseFloat(document.getElementById('inputA').value);
      const hAbs = parseFloat(document.getElementById('inputH').value);
      const kAbs = parseFloat(document.getElementById('inputK').value);
      
      const xMinusHAbs = xValue - hAbs;
      const absResult = Math.abs(xMinusHAbs);
      finalValue = aAbs * absResult + kAbs;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aAbs}|x-${hAbs}| ${kAbs >= 0 ? '+' : ''}${kAbs}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aAbs}|${xValue}-${hAbs}| ${kAbs >= 0 ? '+' : ''}${kAbs}<br>
        f(${xValue}) = ${aAbs}|${xMinusHAbs}| ${kAbs >= 0 ? '+' : ''}${kAbs}<br>
        f(${xValue}) = ${aAbs}Â·${absResult.toFixed(4)} ${kAbs >= 0 ? '+' : ''}${kAbs}<br>
        f(${xValue}) = ${(aAbs * absResult).toFixed(4)} ${kAbs >= 0 ? '+' : ''}${kAbs}
      `;
      break;
      
    case 'logarithm':
      const aLog = parseFloat(document.getElementById('inputA').value);
      const baseLog = parseFloat(document.getElementById('inputBase').value);
      const hLog = parseFloat(document.getElementById('inputH').value);
      const kLog = parseFloat(document.getElementById('inputK').value);
      
      if (xValue <= hLog) {
        alert(`Ù‚ÙŠÙ…Ø© x ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† ${hLog}`);
        return;
      }
      
      const xMinusHLog = xValue - hLog;
      const logResult = Math.log(xMinusHLog) / Math.log(baseLog);
      finalValue = aLog * logResult + kLog;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aLog}Â·log<sub>${baseLog}</sub>(x-${hLog}) ${kLog >= 0 ? '+' : ''}${kLog}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aLog}Â·log<sub>${baseLog}</sub>(${xValue}-${hLog}) ${kLog >= 0 ? '+' : ''}${kLog}<br>
        f(${xValue}) = ${aLog}Â·log<sub>${baseLog}</sub>${xMinusHLog} ${kLog >= 0 ? '+' : ''}${kLog}<br>
        f(${xValue}) = ${aLog}Â·${logResult.toFixed(4)} ${kLog >= 0 ? '+' : ''}${kLog}<br>
        f(${xValue}) = ${(aLog * logResult).toFixed(4)} ${kLog >= 0 ? '+' : ''}${kLog}
      `;
      break;
      
    case 'sine':
      const aSin = parseFloat(document.getElementById('inputA').value);
      const bSin = parseFloat(document.getElementById('inputB').value);
      const hSin = parseFloat(document.getElementById('inputH').value);
      const kSin = parseFloat(document.getElementById('inputK').value);
      
      const angleSin = bSin * (xValue - hSin);
      const sinResult = Math.sin(angleSin);
      finalValue = aSin * sinResult + kSin;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aSin}Â·sin(${bSin}(x-${hSin})) ${kSin >= 0 ? '+' : ''}${kSin}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aSin}Â·sin(${bSin}(${xValue}-${hSin})) ${kSin >= 0 ? '+' : ''}${kSin}<br>
        f(${xValue}) = ${aSin}Â·sin(${angleSin.toFixed(4)}) ${kSin >= 0 ? '+' : ''}${kSin}<br>
        f(${xValue}) = ${aSin}Â·${sinResult.toFixed(4)} ${kSin >= 0 ? '+' : ''}${kSin}<br>
        f(${xValue}) = ${(aSin * sinResult).toFixed(4)} ${kSin >= 0 ? '+' : ''}${kSin}
      `;
      break;
      
    case 'cosine':
      const aCos = parseFloat(document.getElementById('inputA').value);
      const bCos = parseFloat(document.getElementById('inputB').value);
      const hCos = parseFloat(document.getElementById('inputH').value);
      const kCos = parseFloat(document.getElementById('inputK').value);
      
      const angleCos = bCos * (xValue - hCos);
      const cosResult = Math.cos(angleCos);
      finalValue = aCos * cosResult + kCos;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aCos}Â·cos(${bCos}(x-${hCos})) ${kCos >= 0 ? '+' : ''}${kCos}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aCos}Â·cos(${bCos}(${xValue}-${hCos})) ${kCos >= 0 ? '+' : ''}${kCos}<br>
        f(${xValue}) = ${aCos}Â·cos(${angleCos.toFixed(4)}) ${kCos >= 0 ? '+' : ''}${kCos}<br>
        f(${xValue}) = ${aCos}Â·${cosResult.toFixed(4)} ${kCos >= 0 ? '+' : ''}${kCos}<br>
        f(${xValue}) = ${(aCos * cosResult).toFixed(4)} ${kCos >= 0 ? '+' : ''}${kCos}
      `;
      break;
      
    case 'tangent':
      const aTan = parseFloat(document.getElementById('inputA').value);
      const bTan = parseFloat(document.getElementById('inputB').value);
      const hTan = parseFloat(document.getElementById('inputH').value);
      const kTan = parseFloat(document.getElementById('inputK').value);
      
      const angleTan = bTan * (xValue - hTan);
      const tanResult = Math.tan(angleTan);
      
      if (!isFinite(tanResult)) {
        alert('Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø© ØªÙ‚Ø¹ Ø¹Ù†Ø¯ Ø®Ø· ØªÙ‚Ø§Ø±Ø¨ Ø±Ø£Ø³ÙŠ (ØºÙŠØ± Ù…Ø¹Ø±Ù‘ÙØ©)');
        return;
      }
      
      finalValue = aTan * tanResult + kTan;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aTan}Â·tan(${bTan}(x-${hTan})) ${kTan >= 0 ? '+' : ''}${kTan}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aTan}Â·tan(${bTan}(${xValue}-${hTan})) ${kTan >= 0 ? '+' : ''}${kTan}<br>
        f(${xValue}) = ${aTan}Â·tan(${angleTan.toFixed(4)}) ${kTan >= 0 ? '+' : ''}${kTan}<br>
        f(${xValue}) = ${aTan}Â·${tanResult.toFixed(4)} ${kTan >= 0 ? '+' : ''}${kTan}<br>
        f(${xValue}) = ${(aTan * tanResult).toFixed(4)} ${kTan >= 0 ? '+' : ''}${kTan}
      `;
      break;
      
    case 'rational':
      const aRat = parseFloat(document.getElementById('inputA').value);
      const hRat = parseFloat(document.getElementById('inputH').value);
      const kRat = parseFloat(document.getElementById('inputK').value);
      
      if (xValue === hRat) {
        alert(`Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø© ØªÙ‚Ø¹ Ø¹Ù†Ø¯ Ø®Ø· Ø§Ù„ØªÙ‚Ø§Ø±Ø¨ Ø§Ù„Ø±Ø£Ø³ÙŠ x = ${hRat} (ØºÙŠØ± Ù…Ø¹Ø±Ù‘ÙØ©)`);
        return;
      }
      
      const xMinusHRat = xValue - hRat;
      const ratResult = aRat / xMinusHRat;
      finalValue = ratResult + kRat;
      
      steps = `
        <strong>Ø§Ù„Ø¯Ø§Ù„Ø©:</strong> f(x) = ${aRat}/(x-${hRat}) ${kRat >= 0 ? '+' : ''}${kRat}<br>
        <strong>Ø§Ù„ØªØ¹ÙˆÙŠØ¶ Ø¨Ù€ x = ${xValue}:</strong><br>
        f(${xValue}) = ${aRat}/(${xValue}-${hRat}) ${kRat >= 0 ? '+' : ''}${kRat}<br>
        f(${xValue}) = ${aRat}/${xMinusHRat} ${kRat >= 0 ? '+' : ''}${kRat}<br>
        f(${xValue}) = ${ratResult.toFixed(4)} ${kRat >= 0 ? '+' : ''}${kRat}
      `;
      break;
      
    default:
      alert('Ù†ÙˆØ¹ Ø§Ù„Ø¯Ø§Ù„Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
      return;
  }
  
  document.getElementById('stepByStep').innerHTML = steps;
  document.getElementById('finalResult').textContent = `f(${xValue}) = ${finalValue.toFixed(4)}`;
  document.getElementById('substitutionResult').style.display = 'block';
  
  // Scroll to results
  document.getElementById('substitutionResult').scrollIntoView({ behavior: 'smooth' });
}
</script>
